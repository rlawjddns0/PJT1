{"remainingRequest":"C:\\Users\\multicampus\\Desktop\\pjt 1 back\\cowdog_fe\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\multicampus\\Desktop\\pjt 1 back\\cowdog_fe\\node_modules\\element-plus\\lib\\el-tree\\index.js","dependencies":[{"path":"C:\\Users\\multicampus\\Desktop\\pjt 1 back\\cowdog_fe\\node_modules\\element-plus\\lib\\el-tree\\index.js","mtime":1627609663535},{"path":"C:\\Users\\multicampus\\Desktop\\pjt 1 back\\cowdog_fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1627609653894},{"path":"C:\\Users\\multicampus\\Desktop\\pjt 1 back\\cowdog_fe\\node_modules\\babel-loader\\lib\\index.js","mtime":1627609652222}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIHZ1ZSA9IHJlcXVpcmUoJ3Z1ZScpOwoKdmFyIEVsQ29sbGFwc2VUcmFuc2l0aW9uID0gcmVxdWlyZSgnLi4vZWwtY29sbGFwc2UtdHJhbnNpdGlvbicpOwoKdmFyIEVsQ2hlY2tib3ggPSByZXF1aXJlKCcuLi9lbC1jaGVja2JveCcpOwoKdmFyIG1pdHQgPSByZXF1aXJlKCdtaXR0Jyk7Cgp2YXIgZG9tID0gcmVxdWlyZSgnLi4vdXRpbHMvZG9tJyk7Cgp2YXIgYXJpYSA9IHJlcXVpcmUoJy4uL3V0aWxzL2FyaWEnKTsKCnZhciBsb2NhbGUgPSByZXF1aXJlKCcuLi9sb2NhbGUnKTsKCmZ1bmN0aW9uIF9pbnRlcm9wRGVmYXVsdExlZ2FjeShlKSB7CiAgcmV0dXJuIGUgJiYgdHlwZW9mIGUgPT09ICdvYmplY3QnICYmICdkZWZhdWx0JyBpbiBlID8gZSA6IHsKICAgICdkZWZhdWx0JzogZQogIH07Cn0KCnZhciBFbENvbGxhcHNlVHJhbnNpdGlvbl9fZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9faW50ZXJvcERlZmF1bHRMZWdhY3koRWxDb2xsYXBzZVRyYW5zaXRpb24pOwoKdmFyIEVsQ2hlY2tib3hfX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX2ludGVyb3BEZWZhdWx0TGVnYWN5KEVsQ2hlY2tib3gpOwoKdmFyIG1pdHRfX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX2ludGVyb3BEZWZhdWx0TGVnYWN5KG1pdHQpOwovKioNCiAqIE1ha2UgYSBtYXAgYW5kIHJldHVybiBhIGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhIGtleQ0KICogaXMgaW4gdGhhdCBtYXAuDQogKiBJTVBPUlRBTlQ6IGFsbCBjYWxscyBvZiB0aGlzIGZ1bmN0aW9uIG11c3QgYmUgcHJlZml4ZWQgd2l0aA0KICogXC9cKiNcX1xfUFVSRVxfXF9cKlwvDQogKiBTbyB0aGF0IHJvbGx1cCBjYW4gdHJlZS1zaGFrZSB0aGVtIGlmIG5lY2Vzc2FyeS4NCiAqLwoKCmNvbnN0IEVNUFRZX09CSiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgPyBPYmplY3QuZnJlZXplKHt9KSA6IHt9Owpjb25zdCBFTVBUWV9BUlIgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nID8gT2JqZWN0LmZyZWV6ZShbXSkgOiBbXTsKY29uc3QgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5OwoKY29uc3QgaGFzT3duID0gKHZhbCwga2V5KSA9PiBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbCwga2V5KTsKCmNvbnN0IE5PREVfS0VZID0gIiR0cmVlTm9kZUlkIjsKCmNvbnN0IG1hcmtOb2RlRGF0YSA9IGZ1bmN0aW9uIChub2RlLCBkYXRhKSB7CiAgaWYgKCFkYXRhIHx8IGRhdGFbTk9ERV9LRVldKSByZXR1cm47CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRhdGEsIE5PREVfS0VZLCB7CiAgICB2YWx1ZTogbm9kZS5pZCwKICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgIHdyaXRhYmxlOiBmYWxzZQogIH0pOwp9OwoKY29uc3QgZ2V0Tm9kZUtleSA9IGZ1bmN0aW9uIChrZXksIGRhdGEpIHsKICBpZiAoIWtleSkgcmV0dXJuIGRhdGFbTk9ERV9LRVldOwogIHJldHVybiBkYXRhW2tleV07Cn07Cgpjb25zdCBnZXRDaGlsZFN0YXRlID0gbm9kZSA9PiB7CiAgbGV0IGFsbCA9IHRydWU7CiAgbGV0IG5vbmUgPSB0cnVlOwogIGxldCBhbGxXaXRob3V0RGlzYWJsZSA9IHRydWU7CgogIGZvciAobGV0IGkgPSAwLCBqID0gbm9kZS5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgIGNvbnN0IG4gPSBub2RlW2ldOwoKICAgIGlmIChuLmNoZWNrZWQgIT09IHRydWUgfHwgbi5pbmRldGVybWluYXRlKSB7CiAgICAgIGFsbCA9IGZhbHNlOwoKICAgICAgaWYgKCFuLmRpc2FibGVkKSB7CiAgICAgICAgYWxsV2l0aG91dERpc2FibGUgPSBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIGlmIChuLmNoZWNrZWQgIT09IGZhbHNlIHx8IG4uaW5kZXRlcm1pbmF0ZSkgewogICAgICBub25lID0gZmFsc2U7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgYWxsLAogICAgbm9uZSwKICAgIGFsbFdpdGhvdXREaXNhYmxlLAogICAgaGFsZjogIWFsbCAmJiAhbm9uZQogIH07Cn07Cgpjb25zdCByZUluaXRDaGVja2VkID0gZnVuY3Rpb24gKG5vZGUpIHsKICBpZiAobm9kZS5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogIGNvbnN0IHsKICAgIGFsbCwKICAgIG5vbmUsCiAgICBoYWxmCiAgfSA9IGdldENoaWxkU3RhdGUobm9kZS5jaGlsZE5vZGVzKTsKCiAgaWYgKGFsbCkgewogICAgbm9kZS5jaGVja2VkID0gdHJ1ZTsKICAgIG5vZGUuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlOwogIH0gZWxzZSBpZiAoaGFsZikgewogICAgbm9kZS5jaGVja2VkID0gZmFsc2U7CiAgICBub2RlLmluZGV0ZXJtaW5hdGUgPSB0cnVlOwogIH0gZWxzZSBpZiAobm9uZSkgewogICAgbm9kZS5jaGVja2VkID0gZmFsc2U7CiAgICBub2RlLmluZGV0ZXJtaW5hdGUgPSBmYWxzZTsKICB9CgogIGNvbnN0IHBhcmVudCA9IG5vZGUucGFyZW50OwogIGlmICghcGFyZW50IHx8IHBhcmVudC5sZXZlbCA9PT0gMCkgcmV0dXJuOwoKICBpZiAoIW5vZGUuc3RvcmUuY2hlY2tTdHJpY3RseSkgewogICAgcmVJbml0Q2hlY2tlZChwYXJlbnQpOwogIH0KfTsKCmNvbnN0IGdldFByb3BlcnR5RnJvbURhdGEgPSBmdW5jdGlvbiAobm9kZSwgcHJvcCkgewogIGNvbnN0IHByb3BzID0gbm9kZS5zdG9yZS5wcm9wczsKICBjb25zdCBkYXRhID0gbm9kZS5kYXRhIHx8IHt9OwogIGNvbnN0IGNvbmZpZyA9IHByb3BzW3Byb3BdOwoKICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gImZ1bmN0aW9uIikgewogICAgcmV0dXJuIGNvbmZpZyhkYXRhLCBub2RlKTsKICB9IGVsc2UgaWYgKHR5cGVvZiBjb25maWcgPT09ICJzdHJpbmciKSB7CiAgICByZXR1cm4gZGF0YVtjb25maWddOwogIH0gZWxzZSBpZiAodHlwZW9mIGNvbmZpZyA9PT0gInVuZGVmaW5lZCIpIHsKICAgIGNvbnN0IGRhdGFQcm9wID0gZGF0YVtwcm9wXTsKICAgIHJldHVybiBkYXRhUHJvcCA9PT0gdm9pZCAwID8gIiIgOiBkYXRhUHJvcDsKICB9Cn07CgpsZXQgbm9kZUlkU2VlZCA9IDA7CgpjbGFzcyBOb2RlIHsKICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICB0aGlzLmlkID0gbm9kZUlkU2VlZCsrOwogICAgdGhpcy50ZXh0ID0gbnVsbDsKICAgIHRoaXMuY2hlY2tlZCA9IGZhbHNlOwogICAgdGhpcy5pbmRldGVybWluYXRlID0gZmFsc2U7CiAgICB0aGlzLmRhdGEgPSBudWxsOwogICAgdGhpcy5leHBhbmRlZCA9IGZhbHNlOwogICAgdGhpcy5wYXJlbnQgPSBudWxsOwogICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgIHRoaXMuaXNDdXJyZW50ID0gZmFsc2U7CiAgICB0aGlzLmNhbkZvY3VzID0gZmFsc2U7CgogICAgZm9yIChjb25zdCBuYW1lIGluIG9wdGlvbnMpIHsKICAgICAgaWYgKGhhc093bihvcHRpb25zLCBuYW1lKSkgewogICAgICAgIHRoaXNbbmFtZV0gPSBvcHRpb25zW25hbWVdOwogICAgICB9CiAgICB9CgogICAgdGhpcy5sZXZlbCA9IDA7CiAgICB0aGlzLmxvYWRlZCA9IGZhbHNlOwogICAgdGhpcy5jaGlsZE5vZGVzID0gW107CiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKCiAgICBpZiAodGhpcy5wYXJlbnQpIHsKICAgICAgdGhpcy5sZXZlbCA9IHRoaXMucGFyZW50LmxldmVsICsgMTsKICAgIH0KICB9CgogIGluaXRpYWxpemUoKSB7CiAgICBjb25zdCBzdG9yZSA9IHRoaXMuc3RvcmU7CgogICAgaWYgKCFzdG9yZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIltOb2RlXXN0b3JlIGlzIHJlcXVpcmVkISIpOwogICAgfQoKICAgIHN0b3JlLnJlZ2lzdGVyTm9kZSh0aGlzKTsKICAgIGNvbnN0IHByb3BzID0gc3RvcmUucHJvcHM7CgogICAgaWYgKHByb3BzICYmIHR5cGVvZiBwcm9wcy5pc0xlYWYgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGNvbnN0IGlzTGVhZiA9IGdldFByb3BlcnR5RnJvbURhdGEodGhpcywgImlzTGVhZiIpOwoKICAgICAgaWYgKHR5cGVvZiBpc0xlYWYgPT09ICJib29sZWFuIikgewogICAgICAgIHRoaXMuaXNMZWFmQnlVc2VyID0gaXNMZWFmOwogICAgICB9CiAgICB9CgogICAgaWYgKHN0b3JlLmxhenkgIT09IHRydWUgJiYgdGhpcy5kYXRhKSB7CiAgICAgIHRoaXMuc2V0RGF0YSh0aGlzLmRhdGEpOwoKICAgICAgaWYgKHN0b3JlLmRlZmF1bHRFeHBhbmRBbGwpIHsKICAgICAgICB0aGlzLmV4cGFuZGVkID0gdHJ1ZTsKICAgICAgICB0aGlzLmNhbkZvY3VzID0gdHJ1ZTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0aGlzLmxldmVsID4gMCAmJiBzdG9yZS5sYXp5ICYmIHN0b3JlLmRlZmF1bHRFeHBhbmRBbGwpIHsKICAgICAgdGhpcy5leHBhbmQoKTsKICAgIH0KCiAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5kYXRhKSkgewogICAgICBtYXJrTm9kZURhdGEodGhpcywgdGhpcy5kYXRhKTsKICAgIH0KCiAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuOwogICAgY29uc3QgZGVmYXVsdEV4cGFuZGVkS2V5cyA9IHN0b3JlLmRlZmF1bHRFeHBhbmRlZEtleXM7CiAgICBjb25zdCBrZXkgPSBzdG9yZS5rZXk7CgogICAgaWYgKGtleSAmJiBkZWZhdWx0RXhwYW5kZWRLZXlzICYmIGRlZmF1bHRFeHBhbmRlZEtleXMuaW5kZXhPZih0aGlzLmtleSkgIT09IC0xKSB7CiAgICAgIHRoaXMuZXhwYW5kKG51bGwsIHN0b3JlLmF1dG9FeHBhbmRQYXJlbnQpOwogICAgfQoKICAgIGlmIChrZXkgJiYgc3RvcmUuY3VycmVudE5vZGVLZXkgIT09IHZvaWQgMCAmJiB0aGlzLmtleSA9PT0gc3RvcmUuY3VycmVudE5vZGVLZXkpIHsKICAgICAgc3RvcmUuY3VycmVudE5vZGUgPSB0aGlzOwogICAgICBzdG9yZS5jdXJyZW50Tm9kZS5pc0N1cnJlbnQgPSB0cnVlOwogICAgfQoKICAgIGlmIChzdG9yZS5sYXp5KSB7CiAgICAgIHN0b3JlLl9pbml0RGVmYXVsdENoZWNrZWROb2RlKHRoaXMpOwogICAgfQoKICAgIHRoaXMudXBkYXRlTGVhZlN0YXRlKCk7CiAgICBpZiAodGhpcy5wYXJlbnQgJiYgKHRoaXMubGV2ZWwgPT09IDEgfHwgdGhpcy5wYXJlbnQuZXhwYW5kZWQgPT09IHRydWUpKSB0aGlzLmNhbkZvY3VzID0gdHJ1ZTsKICB9CgogIHNldERhdGEoZGF0YSkgewogICAgaWYgKCFBcnJheS5pc0FycmF5KGRhdGEpKSB7CiAgICAgIG1hcmtOb2RlRGF0YSh0aGlzLCBkYXRhKTsKICAgIH0KCiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5jaGlsZE5vZGVzID0gW107CiAgICBsZXQgY2hpbGRyZW47CgogICAgaWYgKHRoaXMubGV2ZWwgPT09IDAgJiYgdGhpcy5kYXRhIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgY2hpbGRyZW4gPSB0aGlzLmRhdGE7CiAgICB9IGVsc2UgewogICAgICBjaGlsZHJlbiA9IGdldFByb3BlcnR5RnJvbURhdGEodGhpcywgImNoaWxkcmVuIikgfHwgW107CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGogPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgdGhpcy5pbnNlcnRDaGlsZCh7CiAgICAgICAgZGF0YTogY2hpbGRyZW5baV0KICAgICAgfSk7CiAgICB9CiAgfQoKICBnZXQgbGFiZWwoKSB7CiAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tRGF0YSh0aGlzLCAibGFiZWwiKTsKICB9CgogIGdldCBrZXkoKSB7CiAgICBjb25zdCBub2RlS2V5ID0gdGhpcy5zdG9yZS5rZXk7CiAgICBpZiAodGhpcy5kYXRhKSByZXR1cm4gdGhpcy5kYXRhW25vZGVLZXldOwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBnZXQgZGlzYWJsZWQoKSB7CiAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tRGF0YSh0aGlzLCAiZGlzYWJsZWQiKTsKICB9CgogIGdldCBuZXh0U2libGluZygpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGFyZW50OwoKICAgIGlmIChwYXJlbnQpIHsKICAgICAgY29uc3QgaW5kZXggPSBwYXJlbnQuY2hpbGROb2Rlcy5pbmRleE9mKHRoaXMpOwoKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICByZXR1cm4gcGFyZW50LmNoaWxkTm9kZXNbaW5kZXggKyAxXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZ2V0IHByZXZpb3VzU2libGluZygpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGFyZW50OwoKICAgIGlmIChwYXJlbnQpIHsKICAgICAgY29uc3QgaW5kZXggPSBwYXJlbnQuY2hpbGROb2Rlcy5pbmRleE9mKHRoaXMpOwoKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICByZXR1cm4gaW5kZXggPiAwID8gcGFyZW50LmNoaWxkTm9kZXNbaW5kZXggLSAxXSA6IG51bGw7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnRhaW5zKHRhcmdldCwgZGVlcCA9IHRydWUpIHsKICAgIHJldHVybiAodGhpcy5jaGlsZE5vZGVzIHx8IFtdKS5zb21lKGNoaWxkID0+IGNoaWxkID09PSB0YXJnZXQgfHwgZGVlcCAmJiBjaGlsZC5jb250YWlucyh0YXJnZXQpKTsKICB9CgogIHJlbW92ZSgpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXMucGFyZW50OwoKICAgIGlmIChwYXJlbnQpIHsKICAgICAgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpOwogICAgfQogIH0KCiAgaW5zZXJ0Q2hpbGQoY2hpbGQsIGluZGV4LCBiYXRjaCkgewogICAgaWYgKCFjaGlsZCkgdGhyb3cgbmV3IEVycm9yKCJpbnNlcnRDaGlsZCBlcnJvcjogY2hpbGQgaXMgcmVxdWlyZWQuIik7CgogICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBOb2RlKSkgewogICAgICBpZiAoIWJhdGNoKSB7CiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmdldENoaWxkcmVuKHRydWUpOwoKICAgICAgICBpZiAoY2hpbGRyZW4uaW5kZXhPZihjaGlsZC5kYXRhKSA9PT0gLTEpIHsKICAgICAgICAgIGlmICh0eXBlb2YgaW5kZXggPT09ICJ1bmRlZmluZWQiIHx8IGluZGV4IDwgMCkgewogICAgICAgICAgICBjaGlsZHJlbi5wdXNoKGNoaWxkLmRhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAwLCBjaGlsZC5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIE9iamVjdC5hc3NpZ24oY2hpbGQsIHsKICAgICAgICBwYXJlbnQ6IHRoaXMsCiAgICAgICAgc3RvcmU6IHRoaXMuc3RvcmUKICAgICAgfSk7CiAgICAgIGNoaWxkID0gdnVlLnJlYWN0aXZlKG5ldyBOb2RlKGNoaWxkKSk7CgogICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBOb2RlKSB7CiAgICAgICAgY2hpbGQuaW5pdGlhbGl6ZSgpOwogICAgICB9CiAgICB9CgogICAgY2hpbGQubGV2ZWwgPSB0aGlzLmxldmVsICsgMTsKCiAgICBpZiAodHlwZW9mIGluZGV4ID09PSAidW5kZWZpbmVkIiB8fCBpbmRleCA8IDApIHsKICAgICAgdGhpcy5jaGlsZE5vZGVzLnB1c2goY2hpbGQpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jaGlsZE5vZGVzLnNwbGljZShpbmRleCwgMCwgY2hpbGQpOwogICAgfQoKICAgIHRoaXMudXBkYXRlTGVhZlN0YXRlKCk7CiAgfQoKICBpbnNlcnRCZWZvcmUoY2hpbGQsIHJlZikgewogICAgbGV0IGluZGV4OwoKICAgIGlmIChyZWYpIHsKICAgICAgaW5kZXggPSB0aGlzLmNoaWxkTm9kZXMuaW5kZXhPZihyZWYpOwogICAgfQoKICAgIHRoaXMuaW5zZXJ0Q2hpbGQoY2hpbGQsIGluZGV4KTsKICB9CgogIGluc2VydEFmdGVyKGNoaWxkLCByZWYpIHsKICAgIGxldCBpbmRleDsKCiAgICBpZiAocmVmKSB7CiAgICAgIGluZGV4ID0gdGhpcy5jaGlsZE5vZGVzLmluZGV4T2YocmVmKTsKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgaW5kZXggKz0gMTsKICAgIH0KCiAgICB0aGlzLmluc2VydENoaWxkKGNoaWxkLCBpbmRleCk7CiAgfQoKICByZW1vdmVDaGlsZChjaGlsZCkgewogICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmdldENoaWxkcmVuKCkgfHwgW107CiAgICBjb25zdCBkYXRhSW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKGNoaWxkLmRhdGEpOwoKICAgIGlmIChkYXRhSW5kZXggPiAtMSkgewogICAgICBjaGlsZHJlbi5zcGxpY2UoZGF0YUluZGV4LCAxKTsKICAgIH0KCiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGROb2Rlcy5pbmRleE9mKGNoaWxkKTsKCiAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICB0aGlzLnN0b3JlICYmIHRoaXMuc3RvcmUuZGVyZWdpc3Rlck5vZGUoY2hpbGQpOwogICAgICBjaGlsZC5wYXJlbnQgPSBudWxsOwogICAgICB0aGlzLmNoaWxkTm9kZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgIH0KCiAgICB0aGlzLnVwZGF0ZUxlYWZTdGF0ZSgpOwogIH0KCiAgcmVtb3ZlQ2hpbGRCeURhdGEoZGF0YSkgewogICAgbGV0IHRhcmdldE5vZGUgPSBudWxsOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICh0aGlzLmNoaWxkTm9kZXNbaV0uZGF0YSA9PT0gZGF0YSkgewogICAgICAgIHRhcmdldE5vZGUgPSB0aGlzLmNoaWxkTm9kZXNbaV07CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGFyZ2V0Tm9kZSkgewogICAgICB0aGlzLnJlbW92ZUNoaWxkKHRhcmdldE5vZGUpOwogICAgfQogIH0KCiAgZXhwYW5kKGNhbGxiYWNrLCBleHBhbmRQYXJlbnQpIHsKICAgIGNvbnN0IGRvbmUgPSAoKSA9PiB7CiAgICAgIGlmIChleHBhbmRQYXJlbnQpIHsKICAgICAgICBsZXQgcGFyZW50ID0gdGhpcy5wYXJlbnQ7CgogICAgICAgIHdoaWxlIChwYXJlbnQubGV2ZWwgPiAwKSB7CiAgICAgICAgICBwYXJlbnQuZXhwYW5kZWQgPSB0cnVlOwogICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZXhwYW5kZWQgPSB0cnVlOwogICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7CiAgICAgIHRoaXMuY2hpbGROb2Rlcy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIGl0ZW0uY2FuRm9jdXMgPSB0cnVlOwogICAgICB9KTsKICAgIH07CgogICAgaWYgKHRoaXMuc2hvdWxkTG9hZERhdGEoKSkgewogICAgICB0aGlzLmxvYWREYXRhKGRhdGEgPT4gewogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7CiAgICAgICAgICBpZiAodGhpcy5jaGVja2VkKSB7CiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZCh0cnVlLCB0cnVlKTsKICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuc3RvcmUuY2hlY2tTdHJpY3RseSkgewogICAgICAgICAgICByZUluaXRDaGVja2VkKHRoaXMpOwogICAgICAgICAgfQoKICAgICAgICAgIGRvbmUoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgZG9uZSgpOwogICAgfQogIH0KCiAgZG9DcmVhdGVDaGlsZHJlbihhcnJheSwgZGVmYXVsdFByb3BzID0ge30pIHsKICAgIGFycmF5LmZvckVhY2goaXRlbSA9PiB7CiAgICAgIHRoaXMuaW5zZXJ0Q2hpbGQoT2JqZWN0LmFzc2lnbih7CiAgICAgICAgZGF0YTogaXRlbQogICAgICB9LCBkZWZhdWx0UHJvcHMpLCB2b2lkIDAsIHRydWUpOwogICAgfSk7CiAgfQoKICBjb2xsYXBzZSgpIHsKICAgIHRoaXMuZXhwYW5kZWQgPSBmYWxzZTsKICAgIHRoaXMuY2hpbGROb2Rlcy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICBpdGVtLmNhbkZvY3VzID0gZmFsc2U7CiAgICB9KTsKICB9CgogIHNob3VsZExvYWREYXRhKCkgewogICAgcmV0dXJuIHRoaXMuc3RvcmUubGF6eSA9PT0gdHJ1ZSAmJiB0aGlzLnN0b3JlLmxvYWQgJiYgIXRoaXMubG9hZGVkOwogIH0KCiAgdXBkYXRlTGVhZlN0YXRlKCkgewogICAgaWYgKHRoaXMuc3RvcmUubGF6eSA9PT0gdHJ1ZSAmJiB0aGlzLmxvYWRlZCAhPT0gdHJ1ZSAmJiB0eXBlb2YgdGhpcy5pc0xlYWZCeVVzZXIgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRoaXMuaXNMZWFmID0gdGhpcy5pc0xlYWZCeVVzZXI7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjaGlsZE5vZGVzID0gdGhpcy5jaGlsZE5vZGVzOwoKICAgIGlmICghdGhpcy5zdG9yZS5sYXp5IHx8IHRoaXMuc3RvcmUubGF6eSA9PT0gdHJ1ZSAmJiB0aGlzLmxvYWRlZCA9PT0gdHJ1ZSkgewogICAgICB0aGlzLmlzTGVhZiA9ICFjaGlsZE5vZGVzIHx8IGNoaWxkTm9kZXMubGVuZ3RoID09PSAwOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5pc0xlYWYgPSBmYWxzZTsKICB9CgogIHNldENoZWNrZWQodmFsdWUsIGRlZXAsIHJlY3Vyc2lvbiwgcGFzc1ZhbHVlKSB7CiAgICB0aGlzLmluZGV0ZXJtaW5hdGUgPSB2YWx1ZSA9PT0gImhhbGYiOwogICAgdGhpcy5jaGVja2VkID0gdmFsdWUgPT09IHRydWU7CiAgICBpZiAodGhpcy5zdG9yZS5jaGVja1N0cmljdGx5KSByZXR1cm47CgogICAgaWYgKCEodGhpcy5zaG91bGRMb2FkRGF0YSgpICYmICF0aGlzLnN0b3JlLmNoZWNrRGVzY2VuZGFudHMpKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBhbGwsCiAgICAgICAgYWxsV2l0aG91dERpc2FibGUKICAgICAgfSA9IGdldENoaWxkU3RhdGUodGhpcy5jaGlsZE5vZGVzKTsKCiAgICAgIGlmICghdGhpcy5pc0xlYWYgJiYgIWFsbCAmJiBhbGxXaXRob3V0RGlzYWJsZSkgewogICAgICAgIHRoaXMuY2hlY2tlZCA9IGZhbHNlOwogICAgICAgIHZhbHVlID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGhhbmRsZURlc2NlbmRhbnRzID0gKCkgPT4gewogICAgICAgIGlmIChkZWVwKSB7CiAgICAgICAgICBjb25zdCBjaGlsZE5vZGVzID0gdGhpcy5jaGlsZE5vZGVzOwoKICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gY2hpbGROb2Rlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZE5vZGVzW2ldOwogICAgICAgICAgICBwYXNzVmFsdWUgPSBwYXNzVmFsdWUgfHwgdmFsdWUgIT09IGZhbHNlOwogICAgICAgICAgICBjb25zdCBpc0NoZWNrID0gY2hpbGQuZGlzYWJsZWQgPyBjaGlsZC5jaGVja2VkIDogcGFzc1ZhbHVlOwogICAgICAgICAgICBjaGlsZC5zZXRDaGVja2VkKGlzQ2hlY2ssIGRlZXAsIHRydWUsIHBhc3NWYWx1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgewogICAgICAgICAgICBoYWxmLAogICAgICAgICAgICBhbGw6IGFsbDIKICAgICAgICAgIH0gPSBnZXRDaGlsZFN0YXRlKGNoaWxkTm9kZXMpOwoKICAgICAgICAgIGlmICghYWxsMikgewogICAgICAgICAgICB0aGlzLmNoZWNrZWQgPSBhbGwyOwogICAgICAgICAgICB0aGlzLmluZGV0ZXJtaW5hdGUgPSBoYWxmOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmICh0aGlzLnNob3VsZExvYWREYXRhKCkpIHsKICAgICAgICB0aGlzLmxvYWREYXRhKCgpID0+IHsKICAgICAgICAgIGhhbmRsZURlc2NlbmRhbnRzKCk7CiAgICAgICAgICByZUluaXRDaGVja2VkKHRoaXMpOwogICAgICAgIH0sIHsKICAgICAgICAgIGNoZWNrZWQ6IHZhbHVlICE9PSBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBoYW5kbGVEZXNjZW5kYW50cygpOwogICAgICB9CiAgICB9CgogICAgY29uc3QgcGFyZW50ID0gdGhpcy5wYXJlbnQ7CiAgICBpZiAoIXBhcmVudCB8fCBwYXJlbnQubGV2ZWwgPT09IDApIHJldHVybjsKCiAgICBpZiAoIXJlY3Vyc2lvbikgewogICAgICByZUluaXRDaGVja2VkKHBhcmVudCk7CiAgICB9CiAgfQoKICBnZXRDaGlsZHJlbihmb3JjZUluaXQgPSBmYWxzZSkgewogICAgaWYgKHRoaXMubGV2ZWwgPT09IDApIHJldHVybiB0aGlzLmRhdGE7CiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDsKICAgIGNvbnN0IHByb3BzID0gdGhpcy5zdG9yZS5wcm9wczsKICAgIGxldCBjaGlsZHJlbiA9ICJjaGlsZHJlbiI7CgogICAgaWYgKHByb3BzKSB7CiAgICAgIGNoaWxkcmVuID0gcHJvcHMuY2hpbGRyZW4gfHwgImNoaWxkcmVuIjsKICAgIH0KCiAgICBpZiAoZGF0YVtjaGlsZHJlbl0gPT09IHZvaWQgMCkgewogICAgICBkYXRhW2NoaWxkcmVuXSA9IG51bGw7CiAgICB9CgogICAgaWYgKGZvcmNlSW5pdCAmJiAhZGF0YVtjaGlsZHJlbl0pIHsKICAgICAgZGF0YVtjaGlsZHJlbl0gPSBbXTsKICAgIH0KCiAgICByZXR1cm4gZGF0YVtjaGlsZHJlbl07CiAgfQoKICB1cGRhdGVDaGlsZHJlbigpIHsKICAgIGNvbnN0IG5ld0RhdGEgPSB0aGlzLmdldENoaWxkcmVuKCkgfHwgW107CiAgICBjb25zdCBvbGREYXRhID0gdGhpcy5jaGlsZE5vZGVzLm1hcChub2RlID0+IG5vZGUuZGF0YSk7CiAgICBjb25zdCBuZXdEYXRhTWFwID0ge307CiAgICBjb25zdCBuZXdOb2RlcyA9IFtdOwogICAgbmV3RGF0YS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gewogICAgICBjb25zdCBrZXkgPSBpdGVtW05PREVfS0VZXTsKICAgICAgY29uc3QgaXNOb2RlRXhpc3RzID0gISFrZXkgJiYgb2xkRGF0YS5maW5kSW5kZXgoZGF0YSA9PiBkYXRhW05PREVfS0VZXSA9PT0ga2V5KSA+PSAwOwoKICAgICAgaWYgKGlzTm9kZUV4aXN0cykgewogICAgICAgIG5ld0RhdGFNYXBba2V5XSA9IHsKICAgICAgICAgIGluZGV4LAogICAgICAgICAgZGF0YTogaXRlbQogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV3Tm9kZXMucHVzaCh7CiAgICAgICAgICBpbmRleCwKICAgICAgICAgIGRhdGE6IGl0ZW0KICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgaWYgKCF0aGlzLnN0b3JlLmxhenkpIHsKICAgICAgb2xkRGF0YS5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIGlmICghbmV3RGF0YU1hcFtpdGVtW05PREVfS0VZXV0pIHRoaXMucmVtb3ZlQ2hpbGRCeURhdGEoaXRlbSk7CiAgICAgIH0pOwogICAgfQoKICAgIG5ld05vZGVzLmZvckVhY2goKHsKICAgICAgaW5kZXgsCiAgICAgIGRhdGEKICAgIH0pID0+IHsKICAgICAgdGhpcy5pbnNlcnRDaGlsZCh7CiAgICAgICAgZGF0YQogICAgICB9LCBpbmRleCk7CiAgICB9KTsKICAgIHRoaXMudXBkYXRlTGVhZlN0YXRlKCk7CiAgfQoKICBsb2FkRGF0YShjYWxsYmFjaywgZGVmYXVsdFByb3BzID0ge30pIHsKICAgIGlmICh0aGlzLnN0b3JlLmxhenkgPT09IHRydWUgJiYgdGhpcy5zdG9yZS5sb2FkICYmICF0aGlzLmxvYWRlZCAmJiAoIXRoaXMubG9hZGluZyB8fCBPYmplY3Qua2V5cyhkZWZhdWx0UHJvcHMpLmxlbmd0aCkpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKCiAgICAgIGNvbnN0IHJlc29sdmUgPSBjaGlsZHJlbiA9PiB7CiAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlOwogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuY2hpbGROb2RlcyA9IFtdOwogICAgICAgIHRoaXMuZG9DcmVhdGVDaGlsZHJlbihjaGlsZHJlbiwgZGVmYXVsdFByb3BzKTsKICAgICAgICB0aGlzLnVwZGF0ZUxlYWZTdGF0ZSgpOwoKICAgICAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgY2hpbGRyZW4pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHRoaXMuc3RvcmUubG9hZCh0aGlzLCByZXNvbHZlKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChjYWxsYmFjaykgewogICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcyk7CiAgICAgIH0KICAgIH0KICB9Cgp9CgpjbGFzcyBUcmVlU3RvcmUgewogIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgIHRoaXMuY3VycmVudE5vZGUgPSBudWxsOwogICAgdGhpcy5jdXJyZW50Tm9kZUtleSA9IG51bGw7CgogICAgZm9yIChjb25zdCBvcHRpb24gaW4gb3B0aW9ucykgewogICAgICBpZiAoaGFzT3duKG9wdGlvbnMsIG9wdGlvbikpIHsKICAgICAgICB0aGlzW29wdGlvbl0gPSBvcHRpb25zW29wdGlvbl07CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLm5vZGVzTWFwID0ge307CiAgfQoKICBpbml0aWFsaXplKCkgewogICAgdGhpcy5yb290ID0gbmV3IE5vZGUoewogICAgICBkYXRhOiB0aGlzLmRhdGEsCiAgICAgIHN0b3JlOiB0aGlzCiAgICB9KTsKICAgIHRoaXMucm9vdC5pbml0aWFsaXplKCk7CgogICAgaWYgKHRoaXMubGF6eSAmJiB0aGlzLmxvYWQpIHsKICAgICAgY29uc3QgbG9hZEZuID0gdGhpcy5sb2FkOwogICAgICBsb2FkRm4odGhpcy5yb290LCBkYXRhID0+IHsKICAgICAgICB0aGlzLnJvb3QuZG9DcmVhdGVDaGlsZHJlbihkYXRhKTsKCiAgICAgICAgdGhpcy5faW5pdERlZmF1bHRDaGVja2VkTm9kZXMoKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9pbml0RGVmYXVsdENoZWNrZWROb2RlcygpOwogICAgfQogIH0KCiAgZmlsdGVyKHZhbHVlKSB7CiAgICBjb25zdCBmaWx0ZXJOb2RlTWV0aG9kID0gdGhpcy5maWx0ZXJOb2RlTWV0aG9kOwogICAgY29uc3QgbGF6eSA9IHRoaXMubGF6eTsKCiAgICBjb25zdCB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChub2RlKSB7CiAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSBub2RlLnJvb3QgPyBub2RlLnJvb3QuY2hpbGROb2RlcyA6IG5vZGUuY2hpbGROb2RlczsKICAgICAgY2hpbGROb2Rlcy5mb3JFYWNoKGNoaWxkID0+IHsKICAgICAgICBjaGlsZC52aXNpYmxlID0gZmlsdGVyTm9kZU1ldGhvZC5jYWxsKGNoaWxkLCB2YWx1ZSwgY2hpbGQuZGF0YSwgY2hpbGQpOwogICAgICAgIHRyYXZlcnNlKGNoaWxkKTsKICAgICAgfSk7CgogICAgICBpZiAoIW5vZGUudmlzaWJsZSAmJiBjaGlsZE5vZGVzLmxlbmd0aCkgewogICAgICAgIGxldCBhbGxIaWRkZW4gPSB0cnVlOwogICAgICAgIGFsbEhpZGRlbiA9ICFjaGlsZE5vZGVzLnNvbWUoY2hpbGQgPT4gY2hpbGQudmlzaWJsZSk7CgogICAgICAgIGlmIChub2RlLnJvb3QpIHsKICAgICAgICAgIG5vZGUucm9vdC52aXNpYmxlID0gYWxsSGlkZGVuID09PSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbm9kZS52aXNpYmxlID0gYWxsSGlkZGVuID09PSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghdmFsdWUpIHJldHVybjsKICAgICAgaWYgKG5vZGUudmlzaWJsZSAmJiAhbm9kZS5pc0xlYWYgJiYgIWxhenkpIG5vZGUuZXhwYW5kKCk7CiAgICB9OwoKICAgIHRyYXZlcnNlKHRoaXMpOwogIH0KCiAgc2V0RGF0YShuZXdWYWwpIHsKICAgIGNvbnN0IGluc3RhbmNlQ2hhbmdlZCA9IG5ld1ZhbCAhPT0gdGhpcy5yb290LmRhdGE7CgogICAgaWYgKGluc3RhbmNlQ2hhbmdlZCkgewogICAgICB0aGlzLnJvb3Quc2V0RGF0YShuZXdWYWwpOwoKICAgICAgdGhpcy5faW5pdERlZmF1bHRDaGVja2VkTm9kZXMoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucm9vdC51cGRhdGVDaGlsZHJlbigpOwogICAgfQogIH0KCiAgZ2V0Tm9kZShkYXRhKSB7CiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIE5vZGUpIHJldHVybiBkYXRhOwogICAgY29uc3Qga2V5ID0gdHlwZW9mIGRhdGEgIT09ICJvYmplY3QiID8gZGF0YSA6IGdldE5vZGVLZXkodGhpcy5rZXksIGRhdGEpOwogICAgcmV0dXJuIHRoaXMubm9kZXNNYXBba2V5XSB8fCBudWxsOwogIH0KCiAgaW5zZXJ0QmVmb3JlKGRhdGEsIHJlZkRhdGEpIHsKICAgIGNvbnN0IHJlZk5vZGUgPSB0aGlzLmdldE5vZGUocmVmRGF0YSk7CiAgICByZWZOb2RlLnBhcmVudC5pbnNlcnRCZWZvcmUoewogICAgICBkYXRhCiAgICB9LCByZWZOb2RlKTsKICB9CgogIGluc2VydEFmdGVyKGRhdGEsIHJlZkRhdGEpIHsKICAgIGNvbnN0IHJlZk5vZGUgPSB0aGlzLmdldE5vZGUocmVmRGF0YSk7CiAgICByZWZOb2RlLnBhcmVudC5pbnNlcnRBZnRlcih7CiAgICAgIGRhdGEKICAgIH0sIHJlZk5vZGUpOwogIH0KCiAgcmVtb3ZlKGRhdGEpIHsKICAgIGNvbnN0IG5vZGUgPSB0aGlzLmdldE5vZGUoZGF0YSk7CgogICAgaWYgKG5vZGUgJiYgbm9kZS5wYXJlbnQpIHsKICAgICAgaWYgKG5vZGUgPT09IHRoaXMuY3VycmVudE5vZGUpIHsKICAgICAgICB0aGlzLmN1cnJlbnROb2RlID0gbnVsbDsKICAgICAgfQoKICAgICAgbm9kZS5wYXJlbnQucmVtb3ZlQ2hpbGQobm9kZSk7CiAgICB9CiAgfQoKICBhcHBlbmQoZGF0YSwgcGFyZW50RGF0YSkgewogICAgY29uc3QgcGFyZW50Tm9kZSA9IHBhcmVudERhdGEgPyB0aGlzLmdldE5vZGUocGFyZW50RGF0YSkgOiB0aGlzLnJvb3Q7CgogICAgaWYgKHBhcmVudE5vZGUpIHsKICAgICAgcGFyZW50Tm9kZS5pbnNlcnRDaGlsZCh7CiAgICAgICAgZGF0YQogICAgICB9KTsKICAgIH0KICB9CgogIF9pbml0RGVmYXVsdENoZWNrZWROb2RlcygpIHsKICAgIGNvbnN0IGRlZmF1bHRDaGVja2VkS2V5cyA9IHRoaXMuZGVmYXVsdENoZWNrZWRLZXlzIHx8IFtdOwogICAgY29uc3Qgbm9kZXNNYXAgPSB0aGlzLm5vZGVzTWFwOwogICAgZGVmYXVsdENoZWNrZWRLZXlzLmZvckVhY2goY2hlY2tlZEtleSA9PiB7CiAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc01hcFtjaGVja2VkS2V5XTsKCiAgICAgIGlmIChub2RlKSB7CiAgICAgICAgbm9kZS5zZXRDaGVja2VkKHRydWUsICF0aGlzLmNoZWNrU3RyaWN0bHkpOwogICAgICB9CiAgICB9KTsKICB9CgogIF9pbml0RGVmYXVsdENoZWNrZWROb2RlKG5vZGUpIHsKICAgIGNvbnN0IGRlZmF1bHRDaGVja2VkS2V5cyA9IHRoaXMuZGVmYXVsdENoZWNrZWRLZXlzIHx8IFtdOwoKICAgIGlmIChkZWZhdWx0Q2hlY2tlZEtleXMuaW5kZXhPZihub2RlLmtleSkgIT09IC0xKSB7CiAgICAgIG5vZGUuc2V0Q2hlY2tlZCh0cnVlLCAhdGhpcy5jaGVja1N0cmljdGx5KTsKICAgIH0KICB9CgogIHNldERlZmF1bHRDaGVja2VkS2V5KG5ld1ZhbCkgewogICAgaWYgKG5ld1ZhbCAhPT0gdGhpcy5kZWZhdWx0Q2hlY2tlZEtleXMpIHsKICAgICAgdGhpcy5kZWZhdWx0Q2hlY2tlZEtleXMgPSBuZXdWYWw7CgogICAgICB0aGlzLl9pbml0RGVmYXVsdENoZWNrZWROb2RlcygpOwogICAgfQogIH0KCiAgcmVnaXN0ZXJOb2RlKG5vZGUpIHsKICAgIGNvbnN0IGtleSA9IHRoaXMua2V5OwogICAgaWYgKCFub2RlIHx8ICFub2RlLmRhdGEpIHJldHVybjsKCiAgICBpZiAoIWtleSkgewogICAgICB0aGlzLm5vZGVzTWFwW25vZGUuaWRdID0gbm9kZTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IG5vZGVLZXkgPSBub2RlLmtleTsKICAgICAgaWYgKG5vZGVLZXkgIT09IHZvaWQgMCkgdGhpcy5ub2Rlc01hcFtub2RlLmtleV0gPSBub2RlOwogICAgfQogIH0KCiAgZGVyZWdpc3Rlck5vZGUobm9kZSkgewogICAgY29uc3Qga2V5ID0gdGhpcy5rZXk7CiAgICBpZiAoIWtleSB8fCAhbm9kZSB8fCAhbm9kZS5kYXRhKSByZXR1cm47CiAgICBub2RlLmNoaWxkTm9kZXMuZm9yRWFjaChjaGlsZCA9PiB7CiAgICAgIHRoaXMuZGVyZWdpc3Rlck5vZGUoY2hpbGQpOwogICAgfSk7CiAgICBkZWxldGUgdGhpcy5ub2Rlc01hcFtub2RlLmtleV07CiAgfQoKICBnZXRDaGVja2VkTm9kZXMobGVhZk9ubHkgPSBmYWxzZSwgaW5jbHVkZUhhbGZDaGVja2VkID0gZmFsc2UpIHsKICAgIGNvbnN0IGNoZWNrZWROb2RlcyA9IFtdOwoKICAgIGNvbnN0IHRyYXZlcnNlID0gZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgY29uc3QgY2hpbGROb2RlcyA9IG5vZGUucm9vdCA/IG5vZGUucm9vdC5jaGlsZE5vZGVzIDogbm9kZS5jaGlsZE5vZGVzOwogICAgICBjaGlsZE5vZGVzLmZvckVhY2goY2hpbGQgPT4gewogICAgICAgIGlmICgoY2hpbGQuY2hlY2tlZCB8fCBpbmNsdWRlSGFsZkNoZWNrZWQgJiYgY2hpbGQuaW5kZXRlcm1pbmF0ZSkgJiYgKCFsZWFmT25seSB8fCBsZWFmT25seSAmJiBjaGlsZC5pc0xlYWYpKSB7CiAgICAgICAgICBjaGVja2VkTm9kZXMucHVzaChjaGlsZC5kYXRhKTsKICAgICAgICB9CgogICAgICAgIHRyYXZlcnNlKGNoaWxkKTsKICAgICAgfSk7CiAgICB9OwoKICAgIHRyYXZlcnNlKHRoaXMpOwogICAgcmV0dXJuIGNoZWNrZWROb2RlczsKICB9CgogIGdldENoZWNrZWRLZXlzKGxlYWZPbmx5ID0gZmFsc2UpIHsKICAgIHJldHVybiB0aGlzLmdldENoZWNrZWROb2RlcyhsZWFmT25seSkubWFwKGRhdGEgPT4gKGRhdGEgfHwge30pW3RoaXMua2V5XSk7CiAgfQoKICBnZXRIYWxmQ2hlY2tlZE5vZGVzKCkgewogICAgY29uc3Qgbm9kZXMgPSBbXTsKCiAgICBjb25zdCB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChub2RlKSB7CiAgICAgIGNvbnN0IGNoaWxkTm9kZXMgPSBub2RlLnJvb3QgPyBub2RlLnJvb3QuY2hpbGROb2RlcyA6IG5vZGUuY2hpbGROb2RlczsKICAgICAgY2hpbGROb2Rlcy5mb3JFYWNoKGNoaWxkID0+IHsKICAgICAgICBpZiAoY2hpbGQuaW5kZXRlcm1pbmF0ZSkgewogICAgICAgICAgbm9kZXMucHVzaChjaGlsZC5kYXRhKTsKICAgICAgICB9CgogICAgICAgIHRyYXZlcnNlKGNoaWxkKTsKICAgICAgfSk7CiAgICB9OwoKICAgIHRyYXZlcnNlKHRoaXMpOwogICAgcmV0dXJuIG5vZGVzOwogIH0KCiAgZ2V0SGFsZkNoZWNrZWRLZXlzKCkgewogICAgcmV0dXJuIHRoaXMuZ2V0SGFsZkNoZWNrZWROb2RlcygpLm1hcChkYXRhID0+IChkYXRhIHx8IHt9KVt0aGlzLmtleV0pOwogIH0KCiAgX2dldEFsbE5vZGVzKCkgewogICAgY29uc3QgYWxsTm9kZXMgPSBbXTsKICAgIGNvbnN0IG5vZGVzTWFwID0gdGhpcy5ub2Rlc01hcDsKCiAgICBmb3IgKGNvbnN0IG5vZGVLZXkgaW4gbm9kZXNNYXApIHsKICAgICAgaWYgKGhhc093bihub2Rlc01hcCwgbm9kZUtleSkpIHsKICAgICAgICBhbGxOb2Rlcy5wdXNoKG5vZGVzTWFwW25vZGVLZXldKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBhbGxOb2RlczsKICB9CgogIHVwZGF0ZUNoaWxkcmVuKGtleSwgZGF0YSkgewogICAgY29uc3Qgbm9kZSA9IHRoaXMubm9kZXNNYXBba2V5XTsKICAgIGlmICghbm9kZSkgcmV0dXJuOwogICAgY29uc3QgY2hpbGROb2RlcyA9IG5vZGUuY2hpbGROb2RlczsKCiAgICBmb3IgKGxldCBpID0gY2hpbGROb2Rlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICBjb25zdCBjaGlsZCA9IGNoaWxkTm9kZXNbaV07CiAgICAgIHRoaXMucmVtb3ZlKGNoaWxkLmRhdGEpOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBqID0gZGF0YS5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgY29uc3QgY2hpbGQgPSBkYXRhW2ldOwogICAgICB0aGlzLmFwcGVuZChjaGlsZCwgbm9kZS5kYXRhKTsKICAgIH0KICB9CgogIF9zZXRDaGVja2VkS2V5cyhrZXksIGxlYWZPbmx5ID0gZmFsc2UsIGNoZWNrZWRLZXlzKSB7CiAgICBjb25zdCBhbGxOb2RlcyA9IHRoaXMuX2dldEFsbE5vZGVzKCkuc29ydCgoYSwgYikgPT4gYi5sZXZlbCAtIGEubGV2ZWwpOwoKICAgIGNvbnN0IGNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhjaGVja2VkS2V5cyk7CiAgICBhbGxOb2Rlcy5mb3JFYWNoKG5vZGUgPT4gbm9kZS5zZXRDaGVja2VkKGZhbHNlLCBmYWxzZSkpOwoKICAgIGZvciAobGV0IGkgPSAwLCBqID0gYWxsTm9kZXMubGVuZ3RoOyBpIDwgajsgaSsrKSB7CiAgICAgIGNvbnN0IG5vZGUgPSBhbGxOb2Rlc1tpXTsKICAgICAgY29uc3Qgbm9kZUtleSA9IG5vZGUuZGF0YVtrZXldLnRvU3RyaW5nKCk7CiAgICAgIGNvbnN0IGNoZWNrZWQgPSBrZXlzLmluZGV4T2Yobm9kZUtleSkgPiAtMTsKCiAgICAgIGlmICghY2hlY2tlZCkgewogICAgICAgIGlmIChub2RlLmNoZWNrZWQgJiYgIWNhY2hlW25vZGVLZXldKSB7CiAgICAgICAgICBub2RlLnNldENoZWNrZWQoZmFsc2UsIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBsZXQgcGFyZW50ID0gbm9kZS5wYXJlbnQ7CgogICAgICB3aGlsZSAocGFyZW50ICYmIHBhcmVudC5sZXZlbCA+IDApIHsKICAgICAgICBjYWNoZVtwYXJlbnQuZGF0YVtrZXldXSA9IHRydWU7CiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDsKICAgICAgfQoKICAgICAgaWYgKG5vZGUuaXNMZWFmIHx8IHRoaXMuY2hlY2tTdHJpY3RseSkgewogICAgICAgIG5vZGUuc2V0Q2hlY2tlZCh0cnVlLCBmYWxzZSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIG5vZGUuc2V0Q2hlY2tlZCh0cnVlLCB0cnVlKTsKCiAgICAgIGlmIChsZWFmT25seSkgewogICAgICAgIG5vZGUuc2V0Q2hlY2tlZChmYWxzZSwgZmFsc2UpOwoKICAgICAgICBjb25zdCB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChub2RlMikgewogICAgICAgICAgY29uc3QgY2hpbGROb2RlcyA9IG5vZGUyLmNoaWxkTm9kZXM7CiAgICAgICAgICBjaGlsZE5vZGVzLmZvckVhY2goY2hpbGQgPT4gewogICAgICAgICAgICBpZiAoIWNoaWxkLmlzTGVhZikgewogICAgICAgICAgICAgIGNoaWxkLnNldENoZWNrZWQoZmFsc2UsIGZhbHNlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJhdmVyc2UoY2hpbGQpOwogICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgdHJhdmVyc2Uobm9kZSk7CiAgICAgIH0KICAgIH0KICB9CgogIHNldENoZWNrZWROb2RlcyhhcnJheSwgbGVhZk9ubHkgPSBmYWxzZSkgewogICAgY29uc3Qga2V5ID0gdGhpcy5rZXk7CiAgICBjb25zdCBjaGVja2VkS2V5cyA9IHt9OwogICAgYXJyYXkuZm9yRWFjaChpdGVtID0+IHsKICAgICAgY2hlY2tlZEtleXNbKGl0ZW0gfHwge30pW2tleV1dID0gdHJ1ZTsKICAgIH0pOwoKICAgIHRoaXMuX3NldENoZWNrZWRLZXlzKGtleSwgbGVhZk9ubHksIGNoZWNrZWRLZXlzKTsKICB9CgogIHNldENoZWNrZWRLZXlzKGtleXMsIGxlYWZPbmx5ID0gZmFsc2UpIHsKICAgIHRoaXMuZGVmYXVsdENoZWNrZWRLZXlzID0ga2V5czsKICAgIGNvbnN0IGtleSA9IHRoaXMua2V5OwogICAgY29uc3QgY2hlY2tlZEtleXMgPSB7fTsKICAgIGtleXMuZm9yRWFjaChrZXkyID0+IHsKICAgICAgY2hlY2tlZEtleXNba2V5Ml0gPSB0cnVlOwogICAgfSk7CgogICAgdGhpcy5fc2V0Q2hlY2tlZEtleXMoa2V5LCBsZWFmT25seSwgY2hlY2tlZEtleXMpOwogIH0KCiAgc2V0RGVmYXVsdEV4cGFuZGVkS2V5cyhrZXlzKSB7CiAgICBrZXlzID0ga2V5cyB8fCBbXTsKICAgIHRoaXMuZGVmYXVsdEV4cGFuZGVkS2V5cyA9IGtleXM7CiAgICBrZXlzLmZvckVhY2goa2V5ID0+IHsKICAgICAgY29uc3Qgbm9kZSA9IHRoaXMuZ2V0Tm9kZShrZXkpOwogICAgICBpZiAobm9kZSkgbm9kZS5leHBhbmQobnVsbCwgdGhpcy5hdXRvRXhwYW5kUGFyZW50KTsKICAgIH0pOwogIH0KCiAgc2V0Q2hlY2tlZChkYXRhLCBjaGVja2VkLCBkZWVwKSB7CiAgICBjb25zdCBub2RlID0gdGhpcy5nZXROb2RlKGRhdGEpOwoKICAgIGlmIChub2RlKSB7CiAgICAgIG5vZGUuc2V0Q2hlY2tlZCghIWNoZWNrZWQsIGRlZXApOwogICAgfQogIH0KCiAgZ2V0Q3VycmVudE5vZGUoKSB7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50Tm9kZTsKICB9CgogIHNldEN1cnJlbnROb2RlKGN1cnJlbnROb2RlKSB7CiAgICBjb25zdCBwcmV2Q3VycmVudE5vZGUgPSB0aGlzLmN1cnJlbnROb2RlOwoKICAgIGlmIChwcmV2Q3VycmVudE5vZGUpIHsKICAgICAgcHJldkN1cnJlbnROb2RlLmlzQ3VycmVudCA9IGZhbHNlOwogICAgfQoKICAgIHRoaXMuY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZTsKICAgIHRoaXMuY3VycmVudE5vZGUuaXNDdXJyZW50ID0gdHJ1ZTsKICB9CgogIHNldFVzZXJDdXJyZW50Tm9kZShub2RlLCBzaG91bGRBdXRvRXhwYW5kUGFyZW50ID0gdHJ1ZSkgewogICAgY29uc3Qga2V5ID0gbm9kZVt0aGlzLmtleV07CiAgICBjb25zdCBjdXJyTm9kZSA9IHRoaXMubm9kZXNNYXBba2V5XTsKICAgIHRoaXMuc2V0Q3VycmVudE5vZGUoY3Vyck5vZGUpOwoKICAgIGlmIChzaG91bGRBdXRvRXhwYW5kUGFyZW50ICYmIHRoaXMuY3VycmVudE5vZGUubGV2ZWwgPiAxKSB7CiAgICAgIHRoaXMuY3VycmVudE5vZGUucGFyZW50LmV4cGFuZChudWxsLCB0cnVlKTsKICAgIH0KICB9CgogIHNldEN1cnJlbnROb2RlS2V5KGtleSwgc2hvdWxkQXV0b0V4cGFuZFBhcmVudCA9IHRydWUpIHsKICAgIGlmIChrZXkgPT09IG51bGwgfHwga2V5ID09PSB2b2lkIDApIHsKICAgICAgdGhpcy5jdXJyZW50Tm9kZSAmJiAodGhpcy5jdXJyZW50Tm9kZS5pc0N1cnJlbnQgPSBmYWxzZSk7CiAgICAgIHRoaXMuY3VycmVudE5vZGUgPSBudWxsOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgbm9kZSA9IHRoaXMuZ2V0Tm9kZShrZXkpOwoKICAgIGlmIChub2RlKSB7CiAgICAgIHRoaXMuc2V0Q3VycmVudE5vZGUobm9kZSk7CgogICAgICBpZiAoc2hvdWxkQXV0b0V4cGFuZFBhcmVudCAmJiB0aGlzLmN1cnJlbnROb2RlLmxldmVsID4gMSkgewogICAgICAgIHRoaXMuY3VycmVudE5vZGUucGFyZW50LmV4cGFuZChudWxsLCB0cnVlKTsKICAgICAgfQogICAgfQogIH0KCn0KCnZhciBzY3JpcHQgPSB2dWUuZGVmaW5lQ29tcG9uZW50KHsKICBuYW1lOiAiRWxUcmVlTm9kZUNvbnRlbnQiLAogIHByb3BzOiB7CiAgICBub2RlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICByZW5kZXJDb250ZW50OiBGdW5jdGlvbgogIH0sCgogIHNldHVwKHByb3BzKSB7CiAgICBjb25zdCBub2RlSW5zdGFuY2UgPSB2dWUuaW5qZWN0KCJOb2RlSW5zdGFuY2UiKTsKICAgIGNvbnN0IHRyZWUgPSB2dWUuaW5qZWN0KCJSb290VHJlZSIpOwogICAgcmV0dXJuICgpID0+IHsKICAgICAgY29uc3Qgbm9kZSA9IHByb3BzLm5vZGU7CiAgICAgIGNvbnN0IHsKICAgICAgICBkYXRhLAogICAgICAgIHN0b3JlCiAgICAgIH0gPSBub2RlOwogICAgICByZXR1cm4gcHJvcHMucmVuZGVyQ29udGVudCA/IHByb3BzLnJlbmRlckNvbnRlbnQodnVlLmgsIHsKICAgICAgICBfc2VsZjogbm9kZUluc3RhbmNlLAogICAgICAgIG5vZGUsCiAgICAgICAgZGF0YSwKICAgICAgICBzdG9yZQogICAgICB9KSA6IHRyZWUuY3R4LnNsb3RzLmRlZmF1bHQgPyB0cmVlLmN0eC5zbG90cy5kZWZhdWx0KHsKICAgICAgICBub2RlLAogICAgICAgIGRhdGEKICAgICAgfSkgOiB2dWUuaCgic3BhbiIsIHsKICAgICAgICBjbGFzczogImVsLXRyZWUtbm9kZV9fbGFiZWwiCiAgICAgIH0sIFtub2RlLmxhYmVsXSk7CiAgICB9OwogIH0KCn0pOwpzY3JpcHQuX19maWxlID0gInBhY2thZ2VzL3RyZWUvc3JjL3RyZWUtbm9kZS1jb250ZW50LnZ1ZSI7CgpmdW5jdGlvbiB1c2VOb2RlRXhwYW5kRXZlbnRCcm9hZGNhc3QocHJvcHMpIHsKICBjb25zdCBwYXJlbnROb2RlTWFwID0gdnVlLmluamVjdCgiVHJlZU5vZGVNYXAiLCBudWxsKTsKICBjb25zdCBjdXJyZW50Tm9kZU1hcCA9IHsKICAgIHRyZWVOb2RlRXhwYW5kOiBub2RlID0+IHsKICAgICAgaWYgKHByb3BzLm5vZGUgIT09IG5vZGUpIHsKICAgICAgICBwcm9wcy5ub2RlLmNvbGxhcHNlKCk7CiAgICAgIH0KICAgIH0sCiAgICBjaGlsZHJlbjogW10KICB9OwoKICBpZiAocGFyZW50Tm9kZU1hcCkgewogICAgcGFyZW50Tm9kZU1hcC5jaGlsZHJlbi5wdXNoKGN1cnJlbnROb2RlTWFwKTsKICB9CgogIHZ1ZS5wcm92aWRlKCJUcmVlTm9kZU1hcCIsIGN1cnJlbnROb2RlTWFwKTsKICByZXR1cm4gewogICAgYnJvYWRjYXN0RXhwYW5kZWQ6IG5vZGUgPT4gewogICAgICBpZiAoIXByb3BzLmFjY29yZGlvbikgcmV0dXJuOwoKICAgICAgZm9yIChjb25zdCBjaGlsZE5vZGUgb2YgY3VycmVudE5vZGVNYXAuY2hpbGRyZW4pIHsKICAgICAgICBjaGlsZE5vZGUudHJlZU5vZGVFeHBhbmQobm9kZSk7CiAgICAgIH0KICAgIH0KICB9Owp9CgpmdW5jdGlvbiB1c2VEcmFnTm9kZUhhbmRsZXIoewogIHByb3BzLAogIGN0eCwKICBlbCQsCiAgZHJvcEluZGljYXRvciQsCiAgc3RvcmUKfSkgewogIGNvbnN0IGVtaXR0ZXIgPSBtaXR0X19kZWZhdWx0WydkZWZhdWx0J10oKTsKICB2dWUucHJvdmlkZSgiRHJhZ05vZGVFbWl0dGVyIiwgZW1pdHRlcik7CiAgY29uc3QgZHJhZ1N0YXRlID0gdnVlLnJlZih7CiAgICBzaG93RHJvcEluZGljYXRvcjogZmFsc2UsCiAgICBkcmFnZ2luZ05vZGU6IG51bGwsCiAgICBkcm9wTm9kZTogbnVsbCwKICAgIGFsbG93RHJvcDogdHJ1ZSwKICAgIGRyb3BUeXBlOiBudWxsCiAgfSk7CiAgZW1pdHRlci5vbigidHJlZS1ub2RlLWRyYWctc3RhcnQiLCAoewogICAgZXZlbnQsCiAgICB0cmVlTm9kZQogIH0pID0+IHsKICAgIGlmICh0eXBlb2YgcHJvcHMuYWxsb3dEcmFnID09PSAiZnVuY3Rpb24iICYmICFwcm9wcy5hbGxvd0RyYWcodHJlZU5vZGUubm9kZSkpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gIm1vdmUiOwoKICAgIHRyeSB7CiAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5zZXREYXRhKCJ0ZXh0L3BsYWluIiwgIiIpOwogICAgfSBjYXRjaCAoZSkge30KCiAgICBkcmFnU3RhdGUudmFsdWUuZHJhZ2dpbmdOb2RlID0gdHJlZU5vZGU7CiAgICBjdHguZW1pdCgibm9kZS1kcmFnLXN0YXJ0IiwgdHJlZU5vZGUubm9kZSwgZXZlbnQpOwogIH0pOwogIGVtaXR0ZXIub24oInRyZWUtbm9kZS1kcmFnLW92ZXIiLCAoewogICAgZXZlbnQsCiAgICB0cmVlTm9kZQogIH0pID0+IHsKICAgIGNvbnN0IGRyb3BOb2RlID0gdHJlZU5vZGU7CiAgICBjb25zdCBvbGREcm9wTm9kZSA9IGRyYWdTdGF0ZS52YWx1ZS5kcm9wTm9kZTsKCiAgICBpZiAob2xkRHJvcE5vZGUgJiYgb2xkRHJvcE5vZGUgIT09IGRyb3BOb2RlKSB7CiAgICAgIGRvbS5yZW1vdmVDbGFzcyhvbGREcm9wTm9kZS4kZWwsICJpcy1kcm9wLWlubmVyIik7CiAgICB9CgogICAgY29uc3QgZHJhZ2dpbmdOb2RlID0gZHJhZ1N0YXRlLnZhbHVlLmRyYWdnaW5nTm9kZTsKICAgIGlmICghZHJhZ2dpbmdOb2RlIHx8ICFkcm9wTm9kZSkgcmV0dXJuOwogICAgbGV0IGRyb3BQcmV2ID0gdHJ1ZTsKICAgIGxldCBkcm9wSW5uZXIgPSB0cnVlOwogICAgbGV0IGRyb3BOZXh0ID0gdHJ1ZTsKICAgIGxldCB1c2VyQWxsb3dEcm9wSW5uZXIgPSB0cnVlOwoKICAgIGlmICh0eXBlb2YgcHJvcHMuYWxsb3dEcm9wID09PSAiZnVuY3Rpb24iKSB7CiAgICAgIGRyb3BQcmV2ID0gcHJvcHMuYWxsb3dEcm9wKGRyYWdnaW5nTm9kZS5ub2RlLCBkcm9wTm9kZS5ub2RlLCAicHJldiIpOwogICAgICB1c2VyQWxsb3dEcm9wSW5uZXIgPSBkcm9wSW5uZXIgPSBwcm9wcy5hbGxvd0Ryb3AoZHJhZ2dpbmdOb2RlLm5vZGUsIGRyb3BOb2RlLm5vZGUsICJpbm5lciIpOwogICAgICBkcm9wTmV4dCA9IHByb3BzLmFsbG93RHJvcChkcmFnZ2luZ05vZGUubm9kZSwgZHJvcE5vZGUubm9kZSwgIm5leHQiKTsKICAgIH0KCiAgICBldmVudC5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IGRyb3BJbm5lciA/ICJtb3ZlIiA6ICJub25lIjsKCiAgICBpZiAoKGRyb3BQcmV2IHx8IGRyb3BJbm5lciB8fCBkcm9wTmV4dCkgJiYgb2xkRHJvcE5vZGUgIT09IGRyb3BOb2RlKSB7CiAgICAgIGlmIChvbGREcm9wTm9kZSkgewogICAgICAgIGN0eC5lbWl0KCJub2RlLWRyYWctbGVhdmUiLCBkcmFnZ2luZ05vZGUubm9kZSwgb2xkRHJvcE5vZGUubm9kZSwgZXZlbnQpOwogICAgICB9CgogICAgICBjdHguZW1pdCgibm9kZS1kcmFnLWVudGVyIiwgZHJhZ2dpbmdOb2RlLm5vZGUsIGRyb3BOb2RlLm5vZGUsIGV2ZW50KTsKICAgIH0KCiAgICBpZiAoZHJvcFByZXYgfHwgZHJvcElubmVyIHx8IGRyb3BOZXh0KSB7CiAgICAgIGRyYWdTdGF0ZS52YWx1ZS5kcm9wTm9kZSA9IGRyb3BOb2RlOwogICAgfQoKICAgIGlmIChkcm9wTm9kZS5ub2RlLm5leHRTaWJsaW5nID09PSBkcmFnZ2luZ05vZGUubm9kZSkgewogICAgICBkcm9wTmV4dCA9IGZhbHNlOwogICAgfQoKICAgIGlmIChkcm9wTm9kZS5ub2RlLnByZXZpb3VzU2libGluZyA9PT0gZHJhZ2dpbmdOb2RlLm5vZGUpIHsKICAgICAgZHJvcFByZXYgPSBmYWxzZTsKICAgIH0KCiAgICBpZiAoZHJvcE5vZGUubm9kZS5jb250YWlucyhkcmFnZ2luZ05vZGUubm9kZSwgZmFsc2UpKSB7CiAgICAgIGRyb3BJbm5lciA9IGZhbHNlOwogICAgfQoKICAgIGlmIChkcmFnZ2luZ05vZGUubm9kZSA9PT0gZHJvcE5vZGUubm9kZSB8fCBkcmFnZ2luZ05vZGUubm9kZS5jb250YWlucyhkcm9wTm9kZS5ub2RlKSkgewogICAgICBkcm9wUHJldiA9IGZhbHNlOwogICAgICBkcm9wSW5uZXIgPSBmYWxzZTsKICAgICAgZHJvcE5leHQgPSBmYWxzZTsKICAgIH0KCiAgICBjb25zdCB0YXJnZXRQb3NpdGlvbiA9IGRyb3BOb2RlLiRlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IHRyZWVQb3NpdGlvbiA9IGVsJC52YWx1ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGxldCBkcm9wVHlwZTsKICAgIGNvbnN0IHByZXZQZXJjZW50ID0gZHJvcFByZXYgPyBkcm9wSW5uZXIgPyAwLjI1IDogZHJvcE5leHQgPyAwLjQ1IDogMSA6IC0xOwogICAgY29uc3QgbmV4dFBlcmNlbnQgPSBkcm9wTmV4dCA/IGRyb3BJbm5lciA/IDAuNzUgOiBkcm9wUHJldiA/IDAuNTUgOiAwIDogMTsKICAgIGxldCBpbmRpY2F0b3JUb3AgPSAtOTk5OTsKICAgIGNvbnN0IGRpc3RhbmNlID0gZXZlbnQuY2xpZW50WSAtIHRhcmdldFBvc2l0aW9uLnRvcDsKCiAgICBpZiAoZGlzdGFuY2UgPCB0YXJnZXRQb3NpdGlvbi5oZWlnaHQgKiBwcmV2UGVyY2VudCkgewogICAgICBkcm9wVHlwZSA9ICJiZWZvcmUiOwogICAgfSBlbHNlIGlmIChkaXN0YW5jZSA+IHRhcmdldFBvc2l0aW9uLmhlaWdodCAqIG5leHRQZXJjZW50KSB7CiAgICAgIGRyb3BUeXBlID0gImFmdGVyIjsKICAgIH0gZWxzZSBpZiAoZHJvcElubmVyKSB7CiAgICAgIGRyb3BUeXBlID0gImlubmVyIjsKICAgIH0gZWxzZSB7CiAgICAgIGRyb3BUeXBlID0gIm5vbmUiOwogICAgfQoKICAgIGNvbnN0IGljb25Qb3NpdGlvbiA9IGRyb3BOb2RlLiRlbC5xdWVyeVNlbGVjdG9yKCIuZWwtdHJlZS1ub2RlX19leHBhbmQtaWNvbiIpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgY29uc3QgZHJvcEluZGljYXRvciA9IGRyb3BJbmRpY2F0b3IkLnZhbHVlOwoKICAgIGlmIChkcm9wVHlwZSA9PT0gImJlZm9yZSIpIHsKICAgICAgaW5kaWNhdG9yVG9wID0gaWNvblBvc2l0aW9uLnRvcCAtIHRyZWVQb3NpdGlvbi50b3A7CiAgICB9IGVsc2UgaWYgKGRyb3BUeXBlID09PSAiYWZ0ZXIiKSB7CiAgICAgIGluZGljYXRvclRvcCA9IGljb25Qb3NpdGlvbi5ib3R0b20gLSB0cmVlUG9zaXRpb24udG9wOwogICAgfQoKICAgIGRyb3BJbmRpY2F0b3Iuc3R5bGUudG9wID0gaW5kaWNhdG9yVG9wICsgInB4IjsKICAgIGRyb3BJbmRpY2F0b3Iuc3R5bGUubGVmdCA9IGljb25Qb3NpdGlvbi5yaWdodCAtIHRyZWVQb3NpdGlvbi5sZWZ0ICsgInB4IjsKCiAgICBpZiAoZHJvcFR5cGUgPT09ICJpbm5lciIpIHsKICAgICAgZG9tLmFkZENsYXNzKGRyb3BOb2RlLiRlbCwgImlzLWRyb3AtaW5uZXIiKTsKICAgIH0gZWxzZSB7CiAgICAgIGRvbS5yZW1vdmVDbGFzcyhkcm9wTm9kZS4kZWwsICJpcy1kcm9wLWlubmVyIik7CiAgICB9CgogICAgZHJhZ1N0YXRlLnZhbHVlLnNob3dEcm9wSW5kaWNhdG9yID0gZHJvcFR5cGUgPT09ICJiZWZvcmUiIHx8IGRyb3BUeXBlID09PSAiYWZ0ZXIiOwogICAgZHJhZ1N0YXRlLnZhbHVlLmFsbG93RHJvcCA9IGRyYWdTdGF0ZS52YWx1ZS5zaG93RHJvcEluZGljYXRvciB8fCB1c2VyQWxsb3dEcm9wSW5uZXI7CiAgICBkcmFnU3RhdGUudmFsdWUuZHJvcFR5cGUgPSBkcm9wVHlwZTsKICAgIGN0eC5lbWl0KCJub2RlLWRyYWctb3ZlciIsIGRyYWdnaW5nTm9kZS5ub2RlLCBkcm9wTm9kZS5ub2RlLCBldmVudCk7CiAgfSk7CiAgZW1pdHRlci5vbigidHJlZS1ub2RlLWRyYWctZW5kIiwgZXZlbnQgPT4gewogICAgY29uc3QgewogICAgICBkcmFnZ2luZ05vZGUsCiAgICAgIGRyb3BUeXBlLAogICAgICBkcm9wTm9kZQogICAgfSA9IGRyYWdTdGF0ZS52YWx1ZTsKICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICBldmVudC5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICJtb3ZlIjsKCiAgICBpZiAoZHJhZ2dpbmdOb2RlICYmIGRyb3BOb2RlKSB7CiAgICAgIGNvbnN0IGRyYWdnaW5nTm9kZUNvcHkgPSB7CiAgICAgICAgZGF0YTogZHJhZ2dpbmdOb2RlLm5vZGUuZGF0YQogICAgICB9OwoKICAgICAgaWYgKGRyb3BUeXBlICE9PSAibm9uZSIpIHsKICAgICAgICBkcmFnZ2luZ05vZGUubm9kZS5yZW1vdmUoKTsKICAgICAgfQoKICAgICAgaWYgKGRyb3BUeXBlID09PSAiYmVmb3JlIikgewogICAgICAgIGRyb3BOb2RlLm5vZGUucGFyZW50Lmluc2VydEJlZm9yZShkcmFnZ2luZ05vZGVDb3B5LCBkcm9wTm9kZS5ub2RlKTsKICAgICAgfSBlbHNlIGlmIChkcm9wVHlwZSA9PT0gImFmdGVyIikgewogICAgICAgIGRyb3BOb2RlLm5vZGUucGFyZW50Lmluc2VydEFmdGVyKGRyYWdnaW5nTm9kZUNvcHksIGRyb3BOb2RlLm5vZGUpOwogICAgICB9IGVsc2UgaWYgKGRyb3BUeXBlID09PSAiaW5uZXIiKSB7CiAgICAgICAgZHJvcE5vZGUubm9kZS5pbnNlcnRDaGlsZChkcmFnZ2luZ05vZGVDb3B5KTsKICAgICAgfQoKICAgICAgaWYgKGRyb3BUeXBlICE9PSAibm9uZSIpIHsKICAgICAgICBzdG9yZS52YWx1ZS5yZWdpc3Rlck5vZGUoZHJhZ2dpbmdOb2RlQ29weSk7CiAgICAgIH0KCiAgICAgIGRvbS5yZW1vdmVDbGFzcyhkcm9wTm9kZS4kZWwsICJpcy1kcm9wLWlubmVyIik7CiAgICAgIGN0eC5lbWl0KCJub2RlLWRyYWctZW5kIiwgZHJhZ2dpbmdOb2RlLm5vZGUsIGRyb3BOb2RlLm5vZGUsIGRyb3BUeXBlLCBldmVudCk7CgogICAgICBpZiAoZHJvcFR5cGUgIT09ICJub25lIikgewogICAgICAgIGN0eC5lbWl0KCJub2RlLWRyb3AiLCBkcmFnZ2luZ05vZGUubm9kZSwgZHJvcE5vZGUubm9kZSwgZHJvcFR5cGUsIGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIGlmIChkcmFnZ2luZ05vZGUgJiYgIWRyb3BOb2RlKSB7CiAgICAgIGN0eC5lbWl0KCJub2RlLWRyYWctZW5kIiwgZHJhZ2dpbmdOb2RlLm5vZGUsIG51bGwsIGRyb3BUeXBlLCBldmVudCk7CiAgICB9CgogICAgZHJhZ1N0YXRlLnZhbHVlLnNob3dEcm9wSW5kaWNhdG9yID0gZmFsc2U7CiAgICBkcmFnU3RhdGUudmFsdWUuZHJhZ2dpbmdOb2RlID0gbnVsbDsKICAgIGRyYWdTdGF0ZS52YWx1ZS5kcm9wTm9kZSA9IG51bGw7CiAgICBkcmFnU3RhdGUudmFsdWUuYWxsb3dEcm9wID0gdHJ1ZTsKICB9KTsKICByZXR1cm4gewogICAgZHJhZ1N0YXRlCiAgfTsKfQoKZnVuY3Rpb24gdXNlRHJhZ05vZGVFbWl0dGVyKCkgewogIGNvbnN0IGVtaXR0ZXIgPSB2dWUuaW5qZWN0KCJEcmFnTm9kZUVtaXR0ZXIiKTsKICByZXR1cm4gewogICAgZW1pdHRlcgogIH07Cn0KCnZhciBzY3JpcHQkMSA9IHZ1ZS5kZWZpbmVDb21wb25lbnQoewogIG5hbWU6ICJFbFRyZWVOb2RlIiwKICBjb21wb25lbnRzOiB7CiAgICBFbENvbGxhcHNlVHJhbnNpdGlvbjogRWxDb2xsYXBzZVRyYW5zaXRpb25fX2RlZmF1bHRbJ2RlZmF1bHQnXSwKICAgIEVsQ2hlY2tib3g6IEVsQ2hlY2tib3hfX2RlZmF1bHRbJ2RlZmF1bHQnXSwKICAgIE5vZGVDb250ZW50OiBzY3JpcHQKICB9LAogIHByb3BzOiB7CiAgICBub2RlOiB7CiAgICAgIHR5cGU6IE5vZGUsCiAgICAgIGRlZmF1bHQ6ICgpID0+ICh7fSkKICAgIH0sCiAgICBwcm9wczogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+ICh7fSkKICAgIH0sCiAgICByZW5kZXJDb250ZW50OiBGdW5jdGlvbiwKICAgIHJlbmRlckFmdGVyRXhwYW5kOiBCb29sZWFuLAogICAgc2hvd0NoZWNrYm94OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9CiAgfSwKICBlbWl0czogWyJub2RlLWV4cGFuZCJdLAoKICBzZXR1cChwcm9wcywgY3R4KSB7CiAgICBjb25zdCB7CiAgICAgIGJyb2FkY2FzdEV4cGFuZGVkCiAgICB9ID0gdXNlTm9kZUV4cGFuZEV2ZW50QnJvYWRjYXN0KHByb3BzKTsKICAgIGNvbnN0IHRyZWUgPSB2dWUuaW5qZWN0KCJSb290VHJlZSIpOwogICAgY29uc3QgZXhwYW5kZWQgPSB2dWUucmVmKGZhbHNlKTsKICAgIGNvbnN0IGNoaWxkTm9kZVJlbmRlcmVkID0gdnVlLnJlZihmYWxzZSk7CiAgICBjb25zdCBvbGRDaGVja2VkID0gdnVlLnJlZihudWxsKTsKICAgIGNvbnN0IG9sZEluZGV0ZXJtaW5hdGUgPSB2dWUucmVmKG51bGwpOwogICAgY29uc3Qgbm9kZSQgPSB2dWUucmVmKG51bGwpOwogICAgY29uc3QgewogICAgICBlbWl0dGVyCiAgICB9ID0gdXNlRHJhZ05vZGVFbWl0dGVyKCk7CiAgICBjb25zdCBpbnN0YW5jZSA9IHZ1ZS5nZXRDdXJyZW50SW5zdGFuY2UoKTsKICAgIHZ1ZS5wcm92aWRlKCJOb2RlSW5zdGFuY2UiLCBpbnN0YW5jZSk7CgogICAgaWYgKCF0cmVlKSB7CiAgICAgIGNvbnNvbGUud2FybigiQ2FuIG5vdCBmaW5kIG5vZGUncyB0cmVlLiIpOwogICAgfQoKICAgIGlmIChwcm9wcy5ub2RlLmV4cGFuZGVkKSB7CiAgICAgIGV4cGFuZGVkLnZhbHVlID0gdHJ1ZTsKICAgICAgY2hpbGROb2RlUmVuZGVyZWQudmFsdWUgPSB0cnVlOwogICAgfQoKICAgIGNvbnN0IGNoaWxkcmVuS2V5ID0gdHJlZS5wcm9wc1siY2hpbGRyZW4iXSB8fCAiY2hpbGRyZW4iOwogICAgdnVlLndhdGNoKCgpID0+IHsKICAgICAgY29uc3QgY2hpbGRyZW4gPSBwcm9wcy5ub2RlLmRhdGFbY2hpbGRyZW5LZXldOwogICAgICByZXR1cm4gY2hpbGRyZW4gJiYgWy4uLmNoaWxkcmVuXTsKICAgIH0sICgpID0+IHsKICAgICAgcHJvcHMubm9kZS51cGRhdGVDaGlsZHJlbigpOwogICAgfSk7CiAgICB2dWUud2F0Y2goKCkgPT4gcHJvcHMubm9kZS5pbmRldGVybWluYXRlLCB2YWwgPT4gewogICAgICBoYW5kbGVTZWxlY3RDaGFuZ2UocHJvcHMubm9kZS5jaGVja2VkLCB2YWwpOwogICAgfSk7CiAgICB2dWUud2F0Y2goKCkgPT4gcHJvcHMubm9kZS5jaGVja2VkLCB2YWwgPT4gewogICAgICBoYW5kbGVTZWxlY3RDaGFuZ2UodmFsLCBwcm9wcy5ub2RlLmluZGV0ZXJtaW5hdGUpOwogICAgfSk7CiAgICB2dWUud2F0Y2goKCkgPT4gcHJvcHMubm9kZS5leHBhbmRlZCwgdmFsID0+IHsKICAgICAgdnVlLm5leHRUaWNrKCgpID0+IGV4cGFuZGVkLnZhbHVlID0gdmFsKTsKCiAgICAgIGlmICh2YWwpIHsKICAgICAgICBjaGlsZE5vZGVSZW5kZXJlZC52YWx1ZSA9IHRydWU7CiAgICAgIH0KICAgIH0pOwoKICAgIGNvbnN0IGdldE5vZGVLZXkkMSA9IG5vZGUgPT4gewogICAgICByZXR1cm4gZ2V0Tm9kZUtleSh0cmVlLnByb3BzLm5vZGVLZXksIG5vZGUuZGF0YSk7CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZVNlbGVjdENoYW5nZSA9IChjaGVja2VkLCBpbmRldGVybWluYXRlKSA9PiB7CiAgICAgIGlmIChvbGRDaGVja2VkLnZhbHVlICE9PSBjaGVja2VkIHx8IG9sZEluZGV0ZXJtaW5hdGUudmFsdWUgIT09IGluZGV0ZXJtaW5hdGUpIHsKICAgICAgICB0cmVlLmN0eC5lbWl0KCJjaGVjay1jaGFuZ2UiLCBwcm9wcy5ub2RlLmRhdGEsIGNoZWNrZWQsIGluZGV0ZXJtaW5hdGUpOwogICAgICB9CgogICAgICBvbGRDaGVja2VkLnZhbHVlID0gY2hlY2tlZDsKICAgICAgb2xkSW5kZXRlcm1pbmF0ZS52YWx1ZSA9IGluZGV0ZXJtaW5hdGU7CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZUNsaWNrID0gKCkgPT4gewogICAgICBjb25zdCBzdG9yZSA9IHRyZWUuc3RvcmUudmFsdWU7CiAgICAgIHN0b3JlLnNldEN1cnJlbnROb2RlKHByb3BzLm5vZGUpOwogICAgICB0cmVlLmN0eC5lbWl0KCJjdXJyZW50LWNoYW5nZSIsIHN0b3JlLmN1cnJlbnROb2RlID8gc3RvcmUuY3VycmVudE5vZGUuZGF0YSA6IG51bGwsIHN0b3JlLmN1cnJlbnROb2RlKTsKICAgICAgdHJlZS5jdXJyZW50Tm9kZS52YWx1ZSA9IHByb3BzLm5vZGU7CgogICAgICBpZiAodHJlZS5wcm9wcy5leHBhbmRPbkNsaWNrTm9kZSkgewogICAgICAgIGhhbmRsZUV4cGFuZEljb25DbGljaygpOwogICAgICB9CgogICAgICBpZiAodHJlZS5wcm9wcy5jaGVja09uQ2xpY2tOb2RlICYmICFwcm9wcy5ub2RlLmRpc2FibGVkKSB7CiAgICAgICAgaGFuZGxlQ2hlY2tDaGFuZ2UobnVsbCwgewogICAgICAgICAgdGFyZ2V0OiB7CiAgICAgICAgICAgIGNoZWNrZWQ6ICFwcm9wcy5ub2RlLmNoZWNrZWQKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdHJlZS5jdHguZW1pdCgibm9kZS1jbGljayIsIHByb3BzLm5vZGUuZGF0YSwgcHJvcHMubm9kZSwgaW5zdGFuY2UpOwogICAgfTsKCiAgICBjb25zdCBoYW5kbGVDb250ZXh0TWVudSA9IGV2ZW50ID0+IHsKICAgICAgaWYgKHRyZWUuaW5zdGFuY2Uudm5vZGUucHJvcHNbIm9uTm9kZUNvbnRleHRtZW51Il0pIHsKICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9CgogICAgICB0cmVlLmN0eC5lbWl0KCJub2RlLWNvbnRleHRtZW51IiwgZXZlbnQsIHByb3BzLm5vZGUuZGF0YSwgcHJvcHMubm9kZSwgaW5zdGFuY2UpOwogICAgfTsKCiAgICBjb25zdCBoYW5kbGVFeHBhbmRJY29uQ2xpY2sgPSAoKSA9PiB7CiAgICAgIGlmIChwcm9wcy5ub2RlLmlzTGVhZikgcmV0dXJuOwoKICAgICAgaWYgKGV4cGFuZGVkLnZhbHVlKSB7CiAgICAgICAgdHJlZS5jdHguZW1pdCgibm9kZS1jb2xsYXBzZSIsIHByb3BzLm5vZGUuZGF0YSwgcHJvcHMubm9kZSwgaW5zdGFuY2UpOwogICAgICAgIHByb3BzLm5vZGUuY29sbGFwc2UoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwcm9wcy5ub2RlLmV4cGFuZCgpOwogICAgICAgIGN0eC5lbWl0KCJub2RlLWV4cGFuZCIsIHByb3BzLm5vZGUuZGF0YSwgcHJvcHMubm9kZSwgaW5zdGFuY2UpOwogICAgICB9CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZUNoZWNrQ2hhbmdlID0gKHZhbHVlLCBldikgPT4gewogICAgICBwcm9wcy5ub2RlLnNldENoZWNrZWQoZXYudGFyZ2V0LmNoZWNrZWQsICF0cmVlLnByb3BzLmNoZWNrU3RyaWN0bHkpOwogICAgICB2dWUubmV4dFRpY2soKCkgPT4gewogICAgICAgIGNvbnN0IHN0b3JlID0gdHJlZS5zdG9yZS52YWx1ZTsKICAgICAgICB0cmVlLmN0eC5lbWl0KCJjaGVjayIsIHByb3BzLm5vZGUuZGF0YSwgewogICAgICAgICAgY2hlY2tlZE5vZGVzOiBzdG9yZS5nZXRDaGVja2VkTm9kZXMoKSwKICAgICAgICAgIGNoZWNrZWRLZXlzOiBzdG9yZS5nZXRDaGVja2VkS2V5cygpLAogICAgICAgICAgaGFsZkNoZWNrZWROb2Rlczogc3RvcmUuZ2V0SGFsZkNoZWNrZWROb2RlcygpLAogICAgICAgICAgaGFsZkNoZWNrZWRLZXlzOiBzdG9yZS5nZXRIYWxmQ2hlY2tlZEtleXMoKQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgaGFuZGxlQ2hpbGROb2RlRXhwYW5kID0gKG5vZGVEYXRhLCBub2RlLCBpbnN0YW5jZTIpID0+IHsKICAgICAgYnJvYWRjYXN0RXhwYW5kZWQobm9kZSk7CiAgICAgIHRyZWUuY3R4LmVtaXQoIm5vZGUtZXhwYW5kIiwgbm9kZURhdGEsIG5vZGUsIGluc3RhbmNlMik7CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZURyYWdTdGFydCA9IGV2ZW50ID0+IHsKICAgICAgaWYgKCF0cmVlLnByb3BzLmRyYWdnYWJsZSkgcmV0dXJuOwogICAgICBlbWl0dGVyLmVtaXQoInRyZWUtbm9kZS1kcmFnLXN0YXJ0IiwgewogICAgICAgIGV2ZW50LAogICAgICAgIHRyZWVOb2RlOiBwcm9wcwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgaGFuZGxlRHJhZ092ZXIgPSBldmVudCA9PiB7CiAgICAgIGlmICghdHJlZS5wcm9wcy5kcmFnZ2FibGUpIHJldHVybjsKICAgICAgZW1pdHRlci5lbWl0KCJ0cmVlLW5vZGUtZHJhZy1vdmVyIiwgewogICAgICAgIGV2ZW50LAogICAgICAgIHRyZWVOb2RlOiB7CiAgICAgICAgICAkZWw6IG5vZGUkLnZhbHVlLAogICAgICAgICAgbm9kZTogcHJvcHMubm9kZQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZURyb3AgPSBldmVudCA9PiB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZURyYWdFbmQgPSBldmVudCA9PiB7CiAgICAgIGlmICghdHJlZS5wcm9wcy5kcmFnZ2FibGUpIHJldHVybjsKICAgICAgZW1pdHRlci5lbWl0KCJ0cmVlLW5vZGUtZHJhZy1lbmQiLCBldmVudCk7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgIG5vZGUkLAogICAgICB0cmVlLAogICAgICBleHBhbmRlZCwKICAgICAgY2hpbGROb2RlUmVuZGVyZWQsCiAgICAgIG9sZENoZWNrZWQsCiAgICAgIG9sZEluZGV0ZXJtaW5hdGUsCiAgICAgIGVtaXR0ZXIsCiAgICAgIHBhcmVudCwKICAgICAgZ2V0Tm9kZUtleTogZ2V0Tm9kZUtleSQxLAogICAgICBoYW5kbGVTZWxlY3RDaGFuZ2UsCiAgICAgIGhhbmRsZUNsaWNrLAogICAgICBoYW5kbGVDb250ZXh0TWVudSwKICAgICAgaGFuZGxlRXhwYW5kSWNvbkNsaWNrLAogICAgICBoYW5kbGVDaGVja0NoYW5nZSwKICAgICAgaGFuZGxlQ2hpbGROb2RlRXhwYW5kLAogICAgICBoYW5kbGVEcmFnU3RhcnQsCiAgICAgIGhhbmRsZURyYWdPdmVyLAogICAgICBoYW5kbGVEcm9wLAogICAgICBoYW5kbGVEcmFnRW5kCiAgICB9OwogIH0KCn0pOwpjb25zdCBfaG9pc3RlZF8xID0gewogIGtleTogMSwKICBjbGFzczogImVsLXRyZWUtbm9kZV9fbG9hZGluZy1pY29uIGVsLWljb24tbG9hZGluZyIKfTsKCmZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICBjb25zdCBfY29tcG9uZW50X2VsX2NoZWNrYm94ID0gdnVlLnJlc29sdmVDb21wb25lbnQoImVsLWNoZWNrYm94Iik7CgogIGNvbnN0IF9jb21wb25lbnRfbm9kZV9jb250ZW50ID0gdnVlLnJlc29sdmVDb21wb25lbnQoIm5vZGUtY29udGVudCIpOwoKICBjb25zdCBfY29tcG9uZW50X2VsX3RyZWVfbm9kZSA9IHZ1ZS5yZXNvbHZlQ29tcG9uZW50KCJlbC10cmVlLW5vZGUiKTsKCiAgY29uc3QgX2NvbXBvbmVudF9lbF9jb2xsYXBzZV90cmFuc2l0aW9uID0gdnVlLnJlc29sdmVDb21wb25lbnQoImVsLWNvbGxhcHNlLXRyYW5zaXRpb24iKTsKCiAgcmV0dXJuIHZ1ZS53aXRoRGlyZWN0aXZlcygodnVlLm9wZW5CbG9jaygpLCB2dWUuY3JlYXRlQmxvY2soImRpdiIsIHsKICAgIHJlZjogIm5vZGUkIiwKICAgIGNsYXNzOiBbImVsLXRyZWUtbm9kZSIsIHsKICAgICAgImlzLWV4cGFuZGVkIjogX2N0eC5leHBhbmRlZCwKICAgICAgImlzLWN1cnJlbnQiOiBfY3R4Lm5vZGUuaXNDdXJyZW50LAogICAgICAiaXMtaGlkZGVuIjogIV9jdHgubm9kZS52aXNpYmxlLAogICAgICAiaXMtZm9jdXNhYmxlIjogIV9jdHgubm9kZS5kaXNhYmxlZCwKICAgICAgImlzLWNoZWNrZWQiOiAhX2N0eC5ub2RlLmRpc2FibGVkICYmIF9jdHgubm9kZS5jaGVja2VkCiAgICB9XSwKICAgIHJvbGU6ICJ0cmVlaXRlbSIsCiAgICB0YWJpbmRleDogIi0xIiwKICAgICJhcmlhLWV4cGFuZGVkIjogX2N0eC5leHBhbmRlZCwKICAgICJhcmlhLWRpc2FibGVkIjogX2N0eC5ub2RlLmRpc2FibGVkLAogICAgImFyaWEtY2hlY2tlZCI6IF9jdHgubm9kZS5jaGVja2VkLAogICAgZHJhZ2dhYmxlOiBfY3R4LnRyZWUucHJvcHMuZHJhZ2dhYmxlLAogICAgImRhdGEta2V5IjogX2N0eC5nZXROb2RlS2V5KF9jdHgubm9kZSksCiAgICBvbkNsaWNrOiBfY2FjaGVbM10gfHwgKF9jYWNoZVszXSA9IHZ1ZS53aXRoTW9kaWZpZXJzKCguLi5hcmdzKSA9PiBfY3R4LmhhbmRsZUNsaWNrICYmIF9jdHguaGFuZGxlQ2xpY2soLi4uYXJncyksIFsic3RvcCJdKSksCiAgICBvbkNvbnRleHRtZW51OiBfY2FjaGVbNF0gfHwgKF9jYWNoZVs0XSA9ICguLi5hcmdzKSA9PiBfY3R4LmhhbmRsZUNvbnRleHRNZW51ICYmIF9jdHguaGFuZGxlQ29udGV4dE1lbnUoLi4uYXJncykpLAogICAgb25EcmFnc3RhcnQ6IF9jYWNoZVs1XSB8fCAoX2NhY2hlWzVdID0gdnVlLndpdGhNb2RpZmllcnMoKC4uLmFyZ3MpID0+IF9jdHguaGFuZGxlRHJhZ1N0YXJ0ICYmIF9jdHguaGFuZGxlRHJhZ1N0YXJ0KC4uLmFyZ3MpLCBbInN0b3AiXSkpLAogICAgb25EcmFnb3ZlcjogX2NhY2hlWzZdIHx8IChfY2FjaGVbNl0gPSB2dWUud2l0aE1vZGlmaWVycygoLi4uYXJncykgPT4gX2N0eC5oYW5kbGVEcmFnT3ZlciAmJiBfY3R4LmhhbmRsZURyYWdPdmVyKC4uLmFyZ3MpLCBbInN0b3AiXSkpLAogICAgb25EcmFnZW5kOiBfY2FjaGVbN10gfHwgKF9jYWNoZVs3XSA9IHZ1ZS53aXRoTW9kaWZpZXJzKCguLi5hcmdzKSA9PiBfY3R4LmhhbmRsZURyYWdFbmQgJiYgX2N0eC5oYW5kbGVEcmFnRW5kKC4uLmFyZ3MpLCBbInN0b3AiXSkpLAogICAgb25Ecm9wOiBfY2FjaGVbOF0gfHwgKF9jYWNoZVs4XSA9IHZ1ZS53aXRoTW9kaWZpZXJzKCguLi5hcmdzKSA9PiBfY3R4LmhhbmRsZURyb3AgJiYgX2N0eC5oYW5kbGVEcm9wKC4uLmFyZ3MpLCBbInN0b3AiXSkpCiAgfSwgW3Z1ZS5jcmVhdGVWTm9kZSgiZGl2IiwgewogICAgY2xhc3M6ICJlbC10cmVlLW5vZGVfX2NvbnRlbnQiLAogICAgc3R5bGU6IHsKICAgICAgInBhZGRpbmctbGVmdCI6IChfY3R4Lm5vZGUubGV2ZWwgLSAxKSAqIF9jdHgudHJlZS5wcm9wcy5pbmRlbnQgKyAicHgiCiAgICB9CiAgfSwgW3Z1ZS5jcmVhdGVWTm9kZSgic3BhbiIsIHsKICAgIGNsYXNzOiBbewogICAgICAiaXMtbGVhZiI6IF9jdHgubm9kZS5pc0xlYWYsCiAgICAgIGV4cGFuZGVkOiAhX2N0eC5ub2RlLmlzTGVhZiAmJiBfY3R4LmV4cGFuZGVkCiAgICB9LCAiZWwtdHJlZS1ub2RlX19leHBhbmQtaWNvbiIsIF9jdHgudHJlZS5wcm9wcy5pY29uQ2xhc3MgPyBfY3R4LnRyZWUucHJvcHMuaWNvbkNsYXNzIDogImVsLWljb24tY2FyZXQtcmlnaHQiXSwKICAgIG9uQ2xpY2s6IF9jYWNoZVsxXSB8fCAoX2NhY2hlWzFdID0gdnVlLndpdGhNb2RpZmllcnMoKC4uLmFyZ3MpID0+IF9jdHguaGFuZGxlRXhwYW5kSWNvbkNsaWNrICYmIF9jdHguaGFuZGxlRXhwYW5kSWNvbkNsaWNrKC4uLmFyZ3MpLCBbInN0b3AiXSkpCiAgfSwgbnVsbCwgMiksIF9jdHguc2hvd0NoZWNrYm94ID8gKHZ1ZS5vcGVuQmxvY2soKSwgdnVlLmNyZWF0ZUJsb2NrKF9jb21wb25lbnRfZWxfY2hlY2tib3gsIHsKICAgIGtleTogMCwKICAgICJtb2RlbC12YWx1ZSI6IF9jdHgubm9kZS5jaGVja2VkLAogICAgaW5kZXRlcm1pbmF0ZTogX2N0eC5ub2RlLmluZGV0ZXJtaW5hdGUsCiAgICBkaXNhYmxlZDogISFfY3R4Lm5vZGUuZGlzYWJsZWQsCiAgICBvbkNsaWNrOiBfY2FjaGVbMl0gfHwgKF9jYWNoZVsyXSA9IHZ1ZS53aXRoTW9kaWZpZXJzKCgpID0+IHt9LCBbInN0b3AiXSkpLAogICAgb25DaGFuZ2U6IF9jdHguaGFuZGxlQ2hlY2tDaGFuZ2UKICB9LCBudWxsLCA4LCBbIm1vZGVsLXZhbHVlIiwgImluZGV0ZXJtaW5hdGUiLCAiZGlzYWJsZWQiLCAib25DaGFuZ2UiXSkpIDogdnVlLmNyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpLCBfY3R4Lm5vZGUubG9hZGluZyA/ICh2dWUub3BlbkJsb2NrKCksIHZ1ZS5jcmVhdGVCbG9jaygic3BhbiIsIF9ob2lzdGVkXzEpKSA6IHZ1ZS5jcmVhdGVDb21tZW50Vk5vZGUoInYtaWYiLCB0cnVlKSwgdnVlLmNyZWF0ZVZOb2RlKF9jb21wb25lbnRfbm9kZV9jb250ZW50LCB7CiAgICBub2RlOiBfY3R4Lm5vZGUsCiAgICAicmVuZGVyLWNvbnRlbnQiOiBfY3R4LnJlbmRlckNvbnRlbnQKICB9LCBudWxsLCA4LCBbIm5vZGUiLCAicmVuZGVyLWNvbnRlbnQiXSldLCA0KSwgdnVlLmNyZWF0ZVZOb2RlKF9jb21wb25lbnRfZWxfY29sbGFwc2VfdHJhbnNpdGlvbiwgbnVsbCwgewogICAgZGVmYXVsdDogdnVlLndpdGhDdHgoKCkgPT4gWyFfY3R4LnJlbmRlckFmdGVyRXhwYW5kIHx8IF9jdHguY2hpbGROb2RlUmVuZGVyZWQgPyB2dWUud2l0aERpcmVjdGl2ZXMoKHZ1ZS5vcGVuQmxvY2soKSwgdnVlLmNyZWF0ZUJsb2NrKCJkaXYiLCB7CiAgICAgIGtleTogMCwKICAgICAgY2xhc3M6ICJlbC10cmVlLW5vZGVfX2NoaWxkcmVuIiwKICAgICAgcm9sZTogImdyb3VwIiwKICAgICAgImFyaWEtZXhwYW5kZWQiOiBfY3R4LmV4cGFuZGVkCiAgICB9LCBbKHZ1ZS5vcGVuQmxvY2sodHJ1ZSksIHZ1ZS5jcmVhdGVCbG9jayh2dWUuRnJhZ21lbnQsIG51bGwsIHZ1ZS5yZW5kZXJMaXN0KF9jdHgubm9kZS5jaGlsZE5vZGVzLCBjaGlsZCA9PiB7CiAgICAgIHJldHVybiB2dWUub3BlbkJsb2NrKCksIHZ1ZS5jcmVhdGVCbG9jayhfY29tcG9uZW50X2VsX3RyZWVfbm9kZSwgewogICAgICAgIGtleTogX2N0eC5nZXROb2RlS2V5KGNoaWxkKSwKICAgICAgICAicmVuZGVyLWNvbnRlbnQiOiBfY3R4LnJlbmRlckNvbnRlbnQsCiAgICAgICAgInJlbmRlci1hZnRlci1leHBhbmQiOiBfY3R4LnJlbmRlckFmdGVyRXhwYW5kLAogICAgICAgICJzaG93LWNoZWNrYm94IjogX2N0eC5zaG93Q2hlY2tib3gsCiAgICAgICAgbm9kZTogY2hpbGQsCiAgICAgICAgb25Ob2RlRXhwYW5kOiBfY3R4LmhhbmRsZUNoaWxkTm9kZUV4cGFuZAogICAgICB9LCBudWxsLCA4LCBbInJlbmRlci1jb250ZW50IiwgInJlbmRlci1hZnRlci1leHBhbmQiLCAic2hvdy1jaGVja2JveCIsICJub2RlIiwgIm9uTm9kZUV4cGFuZCJdKTsKICAgIH0pLCAxMjgpKV0sIDgsIFsiYXJpYS1leHBhbmRlZCJdKSksIFtbdnVlLnZTaG93LCBfY3R4LmV4cGFuZGVkXV0pIDogdnVlLmNyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpXSksCiAgICBfOiAxCiAgfSldLCA0MiwgWyJhcmlhLWV4cGFuZGVkIiwgImFyaWEtZGlzYWJsZWQiLCAiYXJpYS1jaGVja2VkIiwgImRyYWdnYWJsZSIsICJkYXRhLWtleSJdKSksIFtbdnVlLnZTaG93LCBfY3R4Lm5vZGUudmlzaWJsZV1dKTsKfQoKc2NyaXB0JDEucmVuZGVyID0gcmVuZGVyOwpzY3JpcHQkMS5fX2ZpbGUgPSAicGFja2FnZXMvdHJlZS9zcmMvdHJlZS1ub2RlLnZ1ZSI7CgpmdW5jdGlvbiB1c2VLZXlkb3duKHsKICBlbCQKfSwgc3RvcmUpIHsKICBjb25zdCB0cmVlSXRlbXMgPSB2dWUucmVmKFtdKTsKICBjb25zdCBjaGVja2JveEl0ZW1zID0gdnVlLnJlZihbXSk7CiAgdnVlLm9uTW91bnRlZCgoKSA9PiB7CiAgICBpbml0VGFiSW5kZXgoKTsKICAgIGRvbS5vbihlbCQudmFsdWUsICJrZXlkb3duIiwgaGFuZGxlS2V5ZG93bik7CiAgfSk7CiAgdnVlLm9uQmVmb3JlVW5tb3VudCgoKSA9PiB7CiAgICBkb20ub2ZmKGVsJC52YWx1ZSwgImtleWRvd24iLCBoYW5kbGVLZXlkb3duKTsKICB9KTsKICB2dWUub25VcGRhdGVkKCgpID0+IHsKICAgIHRyZWVJdGVtcy52YWx1ZSA9IEFycmF5LmZyb20oZWwkLnZhbHVlLnF1ZXJ5U2VsZWN0b3JBbGwoIltyb2xlPXRyZWVpdGVtXSIpKTsKICAgIGNoZWNrYm94SXRlbXMudmFsdWUgPSBBcnJheS5mcm9tKGVsJC52YWx1ZS5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dFt0eXBlPWNoZWNrYm94XSIpKTsKICB9KTsKICB2dWUud2F0Y2goY2hlY2tib3hJdGVtcywgdmFsID0+IHsKICAgIHZhbC5mb3JFYWNoKGNoZWNrYm94ID0+IHsKICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsICItMSIpOwogICAgfSk7CiAgfSk7CgogIGNvbnN0IGhhbmRsZUtleWRvd24gPSBldiA9PiB7CiAgICBjb25zdCBjdXJyZW50SXRlbSA9IGV2LnRhcmdldDsKICAgIGlmIChjdXJyZW50SXRlbS5jbGFzc05hbWUuaW5kZXhPZigiZWwtdHJlZS1ub2RlIikgPT09IC0xKSByZXR1cm47CiAgICBjb25zdCBjb2RlID0gZXYuY29kZTsKICAgIHRyZWVJdGVtcy52YWx1ZSA9IEFycmF5LmZyb20oZWwkLnZhbHVlLnF1ZXJ5U2VsZWN0b3JBbGwoIi5pcy1mb2N1c2FibGVbcm9sZT10cmVlaXRlbV0iKSk7CiAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0cmVlSXRlbXMudmFsdWUuaW5kZXhPZihjdXJyZW50SXRlbSk7CiAgICBsZXQgbmV4dEluZGV4OwoKICAgIGlmIChbYXJpYS5FVkVOVF9DT0RFLnVwLCBhcmlhLkVWRU5UX0NPREUuZG93bl0uaW5kZXhPZihjb2RlKSA+IC0xKSB7CiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAoY29kZSA9PT0gYXJpYS5FVkVOVF9DT0RFLnVwKSB7CiAgICAgICAgbmV4dEluZGV4ID0gY3VycmVudEluZGV4ID09PSAtMSA/IDAgOiBjdXJyZW50SW5kZXggIT09IDAgPyBjdXJyZW50SW5kZXggLSAxIDogdHJlZUl0ZW1zLnZhbHVlLmxlbmd0aCAtIDE7CiAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IG5leHRJbmRleDsKCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgIGlmIChzdG9yZS52YWx1ZS5nZXROb2RlKHRyZWVJdGVtcy52YWx1ZVtuZXh0SW5kZXhdLmRhdGFzZXQua2V5KS5jYW5Gb2N1cykgYnJlYWs7CiAgICAgICAgICBuZXh0SW5kZXgtLTsKCiAgICAgICAgICBpZiAobmV4dEluZGV4ID09PSBzdGFydEluZGV4KSB7CiAgICAgICAgICAgIG5leHRJbmRleCA9IC0xOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobmV4dEluZGV4IDwgMCkgewogICAgICAgICAgICBuZXh0SW5kZXggPSB0cmVlSXRlbXMudmFsdWUubGVuZ3RoIC0gMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV4dEluZGV4ID0gY3VycmVudEluZGV4ID09PSAtMSA/IDAgOiBjdXJyZW50SW5kZXggPCB0cmVlSXRlbXMudmFsdWUubGVuZ3RoIC0gMSA/IGN1cnJlbnRJbmRleCArIDEgOiAwOwogICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBuZXh0SW5kZXg7CgogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICBpZiAoc3RvcmUudmFsdWUuZ2V0Tm9kZSh0cmVlSXRlbXMudmFsdWVbbmV4dEluZGV4XS5kYXRhc2V0LmtleSkuY2FuRm9jdXMpIGJyZWFrOwogICAgICAgICAgbmV4dEluZGV4Kys7CgogICAgICAgICAgaWYgKG5leHRJbmRleCA9PT0gc3RhcnRJbmRleCkgewogICAgICAgICAgICBuZXh0SW5kZXggPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG5leHRJbmRleCA+PSB0cmVlSXRlbXMudmFsdWUubGVuZ3RoKSB7CiAgICAgICAgICAgIG5leHRJbmRleCA9IDA7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBuZXh0SW5kZXggIT09IC0xICYmIHRyZWVJdGVtcy52YWx1ZVtuZXh0SW5kZXhdLmZvY3VzKCk7CiAgICB9CgogICAgaWYgKFthcmlhLkVWRU5UX0NPREUubGVmdCwgYXJpYS5FVkVOVF9DT0RFLnJpZ2h0XS5pbmRleE9mKGNvZGUpID4gLTEpIHsKICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgY3VycmVudEl0ZW0uY2xpY2soKTsKICAgIH0KCiAgICBjb25zdCBoYXNJbnB1dCA9IGN1cnJlbnRJdGVtLnF1ZXJ5U2VsZWN0b3IoJ1t0eXBlPSJjaGVja2JveCJdJyk7CgogICAgaWYgKFthcmlhLkVWRU5UX0NPREUuZW50ZXIsIGFyaWEuRVZFTlRfQ09ERS5zcGFjZV0uaW5kZXhPZihjb2RlKSA+IC0xICYmIGhhc0lucHV0KSB7CiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGhhc0lucHV0LmNsaWNrKCk7CiAgICB9CiAgfTsKCiAgY29uc3QgaW5pdFRhYkluZGV4ID0gKCkgPT4gewogICAgdmFyIF9hOwoKICAgIHRyZWVJdGVtcy52YWx1ZSA9IEFycmF5LmZyb20oZWwkLnZhbHVlLnF1ZXJ5U2VsZWN0b3JBbGwoIi5pcy1mb2N1c2FibGVbcm9sZT10cmVlaXRlbV0iKSk7CiAgICBjaGVja2JveEl0ZW1zLnZhbHVlID0gQXJyYXkuZnJvbShlbCQudmFsdWUucXVlcnlTZWxlY3RvckFsbCgiaW5wdXRbdHlwZT1jaGVja2JveF0iKSk7CiAgICBjb25zdCBjaGVja2VkSXRlbSA9IGVsJC52YWx1ZS5xdWVyeVNlbGVjdG9yQWxsKCIuaXMtY2hlY2tlZFtyb2xlPXRyZWVpdGVtXSIpOwoKICAgIGlmIChjaGVja2VkSXRlbS5sZW5ndGgpIHsKICAgICAgY2hlY2tlZEl0ZW1bMF0uc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsICIwIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAoX2EgPSB0cmVlSXRlbXMudmFsdWVbMF0pID09IG51bGwgPyB2b2lkIDAgOiBfYS5zZXRBdHRyaWJ1dGUoInRhYmluZGV4IiwgIjAiKTsKICB9Owp9Cgp2YXIgc2NyaXB0JDIgPSB2dWUuZGVmaW5lQ29tcG9uZW50KHsKICBuYW1lOiAiRWxUcmVlIiwKICBjb21wb25lbnRzOiB7CiAgICBFbFRyZWVOb2RlOiBzY3JpcHQkMQogIH0sCiAgcHJvcHM6IHsKICAgIGRhdGE6IHsKICAgICAgdHlwZTogQXJyYXkKICAgIH0sCiAgICBlbXB0eVRleHQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAoKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gbG9jYWxlLnQoImVsLnRyZWUuZW1wdHlUZXh0Iik7CiAgICAgIH0KCiAgICB9LAogICAgcmVuZGVyQWZ0ZXJFeHBhbmQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIG5vZGVLZXk6IFN0cmluZywKICAgIGNoZWNrU3RyaWN0bHk6IEJvb2xlYW4sCiAgICBkZWZhdWx0RXhwYW5kQWxsOiBCb29sZWFuLAogICAgZXhwYW5kT25DbGlja05vZGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIGNoZWNrT25DbGlja05vZGU6IEJvb2xlYW4sCiAgICBjaGVja0Rlc2NlbmRhbnRzOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgYXV0b0V4cGFuZFBhcmVudDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgZGVmYXVsdENoZWNrZWRLZXlzOiBBcnJheSwKICAgIGRlZmF1bHRFeHBhbmRlZEtleXM6IEFycmF5LAogICAgY3VycmVudE5vZGVLZXk6IFtTdHJpbmcsIE51bWJlcl0sCiAgICByZW5kZXJDb250ZW50OiBGdW5jdGlvbiwKICAgIHNob3dDaGVja2JveDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGRyYWdnYWJsZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGFsbG93RHJhZzogRnVuY3Rpb24sCiAgICBhbGxvd0Ryb3A6IEZ1bmN0aW9uLAogICAgcHJvcHM6IHsKICAgICAgdHlwZTogT2JqZWN0LAoKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgY2hpbGRyZW46ICJjaGlsZHJlbiIsCiAgICAgICAgICBsYWJlbDogImxhYmVsIiwKICAgICAgICAgIGRpc2FibGVkOiAiZGlzYWJsZWQiCiAgICAgICAgfTsKICAgICAgfQoKICAgIH0sCiAgICBsYXp5OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgaGlnaGxpZ2h0Q3VycmVudDogQm9vbGVhbiwKICAgIGxvYWQ6IEZ1bmN0aW9uLAogICAgZmlsdGVyTm9kZU1ldGhvZDogRnVuY3Rpb24sCiAgICBhY2NvcmRpb246IEJvb2xlYW4sCiAgICBpbmRlbnQ6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAxOAogICAgfSwKICAgIGljb25DbGFzczogU3RyaW5nCiAgfSwKICBlbWl0czogWyJjaGVjay1jaGFuZ2UiLCAiY3VycmVudC1jaGFuZ2UiLCAibm9kZS1jbGljayIsICJub2RlLWNvbnRleHRtZW51IiwgIm5vZGUtY29sbGFwc2UiLCAibm9kZS1leHBhbmQiLCAiY2hlY2siLCAibm9kZS1kcmFnLXN0YXJ0IiwgIm5vZGUtZHJhZy1lbmQiLCAibm9kZS1kcm9wIiwgIm5vZGUtZHJhZy1sZWF2ZSIsICJub2RlLWRyYWctZW50ZXIiLCAibm9kZS1kcmFnLW92ZXIiXSwKCiAgc2V0dXAocHJvcHMsIGN0eCkgewogICAgY29uc3Qgc3RvcmUgPSB2dWUucmVmKG5ldyBUcmVlU3RvcmUoewogICAgICBrZXk6IHByb3BzLm5vZGVLZXksCiAgICAgIGRhdGE6IHByb3BzLmRhdGEsCiAgICAgIGxhenk6IHByb3BzLmxhenksCiAgICAgIHByb3BzOiBwcm9wcy5wcm9wcywKICAgICAgbG9hZDogcHJvcHMubG9hZCwKICAgICAgY3VycmVudE5vZGVLZXk6IHByb3BzLmN1cnJlbnROb2RlS2V5LAogICAgICBjaGVja1N0cmljdGx5OiBwcm9wcy5jaGVja1N0cmljdGx5LAogICAgICBjaGVja0Rlc2NlbmRhbnRzOiBwcm9wcy5jaGVja0Rlc2NlbmRhbnRzLAogICAgICBkZWZhdWx0Q2hlY2tlZEtleXM6IHByb3BzLmRlZmF1bHRDaGVja2VkS2V5cywKICAgICAgZGVmYXVsdEV4cGFuZGVkS2V5czogcHJvcHMuZGVmYXVsdEV4cGFuZGVkS2V5cywKICAgICAgYXV0b0V4cGFuZFBhcmVudDogcHJvcHMuYXV0b0V4cGFuZFBhcmVudCwKICAgICAgZGVmYXVsdEV4cGFuZEFsbDogcHJvcHMuZGVmYXVsdEV4cGFuZEFsbCwKICAgICAgZmlsdGVyTm9kZU1ldGhvZDogcHJvcHMuZmlsdGVyTm9kZU1ldGhvZAogICAgfSkpOwogICAgc3RvcmUudmFsdWUuaW5pdGlhbGl6ZSgpOwogICAgY29uc3Qgcm9vdCA9IHZ1ZS5yZWYoc3RvcmUudmFsdWUucm9vdCk7CiAgICBjb25zdCBjdXJyZW50Tm9kZSA9IHZ1ZS5yZWYobnVsbCk7CiAgICBjb25zdCBlbCQgPSB2dWUucmVmKG51bGwpOwogICAgY29uc3QgZHJvcEluZGljYXRvciQgPSB2dWUucmVmKG51bGwpOwogICAgY29uc3QgewogICAgICBicm9hZGNhc3RFeHBhbmRlZAogICAgfSA9IHVzZU5vZGVFeHBhbmRFdmVudEJyb2FkY2FzdChwcm9wcyk7CiAgICBjb25zdCB7CiAgICAgIGRyYWdTdGF0ZQogICAgfSA9IHVzZURyYWdOb2RlSGFuZGxlcih7CiAgICAgIHByb3BzLAogICAgICBjdHgsCiAgICAgIGVsJCwKICAgICAgZHJvcEluZGljYXRvciQsCiAgICAgIHN0b3JlCiAgICB9KTsKICAgIHVzZUtleWRvd24oewogICAgICBlbCQKICAgIH0sIHN0b3JlKTsKICAgIGNvbnN0IGlzRW1wdHkgPSB2dWUuY29tcHV0ZWQoKCkgPT4gewogICAgICBjb25zdCB7CiAgICAgICAgY2hpbGROb2RlcwogICAgICB9ID0gcm9vdC52YWx1ZTsKICAgICAgcmV0dXJuICFjaGlsZE5vZGVzIHx8IGNoaWxkTm9kZXMubGVuZ3RoID09PSAwIHx8IGNoaWxkTm9kZXMuZXZlcnkoKHsKICAgICAgICB2aXNpYmxlCiAgICAgIH0pID0+ICF2aXNpYmxlKTsKICAgIH0pOwogICAgdnVlLndhdGNoKCgpID0+IHByb3BzLmRlZmF1bHRDaGVja2VkS2V5cywgbmV3VmFsID0+IHsKICAgICAgc3RvcmUudmFsdWUuc2V0RGVmYXVsdENoZWNrZWRLZXkobmV3VmFsKTsKICAgIH0pOwogICAgdnVlLndhdGNoKCgpID0+IHByb3BzLmRlZmF1bHRFeHBhbmRlZEtleXMsIG5ld1ZhbCA9PiB7CiAgICAgIHN0b3JlLnZhbHVlLmRlZmF1bHRFeHBhbmRlZEtleXMgPSBuZXdWYWw7CiAgICAgIHN0b3JlLnZhbHVlLnNldERlZmF1bHRFeHBhbmRlZEtleXMobmV3VmFsKTsKICAgIH0pOwogICAgdnVlLndhdGNoKCgpID0+IHByb3BzLmRhdGEsIG5ld1ZhbCA9PiB7CiAgICAgIHN0b3JlLnZhbHVlLnNldERhdGEobmV3VmFsKTsKICAgIH0sIHsKICAgICAgZGVlcDogdHJ1ZQogICAgfSk7CiAgICB2dWUud2F0Y2goKCkgPT4gcHJvcHMuY2hlY2tTdHJpY3RseSwgbmV3VmFsID0+IHsKICAgICAgc3RvcmUudmFsdWUuY2hlY2tTdHJpY3RseSA9IG5ld1ZhbDsKICAgIH0pOwoKICAgIGNvbnN0IGZpbHRlciA9IHZhbHVlID0+IHsKICAgICAgaWYgKCFwcm9wcy5maWx0ZXJOb2RlTWV0aG9kKSB0aHJvdyBuZXcgRXJyb3IoIltUcmVlXSBmaWx0ZXJOb2RlTWV0aG9kIGlzIHJlcXVpcmVkIHdoZW4gZmlsdGVyIik7CiAgICAgIHN0b3JlLnZhbHVlLmZpbHRlcih2YWx1ZSk7CiAgICB9OwoKICAgIGNvbnN0IGdldE5vZGVLZXkkMSA9IG5vZGUgPT4gewogICAgICByZXR1cm4gZ2V0Tm9kZUtleShwcm9wcy5ub2RlS2V5LCBub2RlLmRhdGEpOwogICAgfTsKCiAgICBjb25zdCBnZXROb2RlUGF0aCA9IGRhdGEgPT4gewogICAgICBpZiAoIXByb3BzLm5vZGVLZXkpIHRocm93IG5ldyBFcnJvcigiW1RyZWVdIG5vZGVLZXkgaXMgcmVxdWlyZWQgaW4gZ2V0Tm9kZVBhdGgiKTsKICAgICAgY29uc3Qgbm9kZSA9IHN0b3JlLnZhbHVlLmdldE5vZGUoZGF0YSk7CiAgICAgIGlmICghbm9kZSkgcmV0dXJuIFtdOwogICAgICBjb25zdCBwYXRoID0gW25vZGUuZGF0YV07CiAgICAgIGxldCBwYXJlbnQgPSBub2RlLnBhcmVudDsKCiAgICAgIHdoaWxlIChwYXJlbnQgJiYgcGFyZW50ICE9PSByb290LnZhbHVlKSB7CiAgICAgICAgcGF0aC5wdXNoKHBhcmVudC5kYXRhKTsKICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50OwogICAgICB9CgogICAgICByZXR1cm4gcGF0aC5yZXZlcnNlKCk7CiAgICB9OwoKICAgIGNvbnN0IGdldENoZWNrZWROb2RlcyA9IChsZWFmT25seSwgaW5jbHVkZUhhbGZDaGVja2VkKSA9PiB7CiAgICAgIHJldHVybiBzdG9yZS52YWx1ZS5nZXRDaGVja2VkTm9kZXMobGVhZk9ubHksIGluY2x1ZGVIYWxmQ2hlY2tlZCk7CiAgICB9OwoKICAgIGNvbnN0IGdldENoZWNrZWRLZXlzID0gbGVhZk9ubHkgPT4gewogICAgICByZXR1cm4gc3RvcmUudmFsdWUuZ2V0Q2hlY2tlZEtleXMobGVhZk9ubHkpOwogICAgfTsKCiAgICBjb25zdCBnZXRDdXJyZW50Tm9kZSA9ICgpID0+IHsKICAgICAgY29uc3QgY3VycmVudE5vZGUyID0gc3RvcmUudmFsdWUuZ2V0Q3VycmVudE5vZGUoKTsKICAgICAgcmV0dXJuIGN1cnJlbnROb2RlMiA/IGN1cnJlbnROb2RlMi5kYXRhIDogbnVsbDsKICAgIH07CgogICAgY29uc3QgZ2V0Q3VycmVudEtleSA9ICgpID0+IHsKICAgICAgaWYgKCFwcm9wcy5ub2RlS2V5KSB0aHJvdyBuZXcgRXJyb3IoIltUcmVlXSBub2RlS2V5IGlzIHJlcXVpcmVkIGluIGdldEN1cnJlbnRLZXkiKTsKICAgICAgY29uc3QgY3VycmVudE5vZGUyID0gZ2V0Q3VycmVudE5vZGUoKTsKICAgICAgcmV0dXJuIGN1cnJlbnROb2RlMiA/IGN1cnJlbnROb2RlMltwcm9wcy5ub2RlS2V5XSA6IG51bGw7CiAgICB9OwoKICAgIGNvbnN0IHNldENoZWNrZWROb2RlcyA9IChub2RlcywgbGVhZk9ubHkpID0+IHsKICAgICAgaWYgKCFwcm9wcy5ub2RlS2V5KSB0aHJvdyBuZXcgRXJyb3IoIltUcmVlXSBub2RlS2V5IGlzIHJlcXVpcmVkIGluIHNldENoZWNrZWROb2RlcyIpOwogICAgICBzdG9yZS52YWx1ZS5zZXRDaGVja2VkTm9kZXMobm9kZXMsIGxlYWZPbmx5KTsKICAgIH07CgogICAgY29uc3Qgc2V0Q2hlY2tlZEtleXMgPSAoa2V5cywgbGVhZk9ubHkpID0+IHsKICAgICAgaWYgKCFwcm9wcy5ub2RlS2V5KSB0aHJvdyBuZXcgRXJyb3IoIltUcmVlXSBub2RlS2V5IGlzIHJlcXVpcmVkIGluIHNldENoZWNrZWRLZXlzIik7CiAgICAgIHN0b3JlLnZhbHVlLnNldENoZWNrZWRLZXlzKGtleXMsIGxlYWZPbmx5KTsKICAgIH07CgogICAgY29uc3Qgc2V0Q2hlY2tlZCA9IChkYXRhLCBjaGVja2VkLCBkZWVwKSA9PiB7CiAgICAgIHN0b3JlLnZhbHVlLnNldENoZWNrZWQoZGF0YSwgY2hlY2tlZCwgZGVlcCk7CiAgICB9OwoKICAgIGNvbnN0IGdldEhhbGZDaGVja2VkTm9kZXMgPSAoKSA9PiB7CiAgICAgIHJldHVybiBzdG9yZS52YWx1ZS5nZXRIYWxmQ2hlY2tlZE5vZGVzKCk7CiAgICB9OwoKICAgIGNvbnN0IGdldEhhbGZDaGVja2VkS2V5cyA9ICgpID0+IHsKICAgICAgcmV0dXJuIHN0b3JlLnZhbHVlLmdldEhhbGZDaGVja2VkS2V5cygpOwogICAgfTsKCiAgICBjb25zdCBzZXRDdXJyZW50Tm9kZSA9IChub2RlLCBzaG91bGRBdXRvRXhwYW5kUGFyZW50ID0gdHJ1ZSkgPT4gewogICAgICBpZiAoIXByb3BzLm5vZGVLZXkpIHRocm93IG5ldyBFcnJvcigiW1RyZWVdIG5vZGVLZXkgaXMgcmVxdWlyZWQgaW4gc2V0Q3VycmVudE5vZGUiKTsKICAgICAgc3RvcmUudmFsdWUuc2V0VXNlckN1cnJlbnROb2RlKG5vZGUsIHNob3VsZEF1dG9FeHBhbmRQYXJlbnQpOwogICAgfTsKCiAgICBjb25zdCBzZXRDdXJyZW50S2V5ID0gKGtleSwgc2hvdWxkQXV0b0V4cGFuZFBhcmVudCA9IHRydWUpID0+IHsKICAgICAgaWYgKCFwcm9wcy5ub2RlS2V5KSB0aHJvdyBuZXcgRXJyb3IoIltUcmVlXSBub2RlS2V5IGlzIHJlcXVpcmVkIGluIHNldEN1cnJlbnRLZXkiKTsKICAgICAgc3RvcmUudmFsdWUuc2V0Q3VycmVudE5vZGVLZXkoa2V5LCBzaG91bGRBdXRvRXhwYW5kUGFyZW50KTsKICAgIH07CgogICAgY29uc3QgZ2V0Tm9kZSA9IGRhdGEgPT4gewogICAgICByZXR1cm4gc3RvcmUudmFsdWUuZ2V0Tm9kZShkYXRhKTsKICAgIH07CgogICAgY29uc3QgcmVtb3ZlID0gZGF0YSA9PiB7CiAgICAgIHN0b3JlLnZhbHVlLnJlbW92ZShkYXRhKTsKICAgIH07CgogICAgY29uc3QgYXBwZW5kID0gKGRhdGEsIHBhcmVudE5vZGUpID0+IHsKICAgICAgc3RvcmUudmFsdWUuYXBwZW5kKGRhdGEsIHBhcmVudE5vZGUpOwogICAgfTsKCiAgICBjb25zdCBpbnNlcnRCZWZvcmUgPSAoZGF0YSwgcmVmTm9kZSkgPT4gewogICAgICBzdG9yZS52YWx1ZS5pbnNlcnRCZWZvcmUoZGF0YSwgcmVmTm9kZSk7CiAgICB9OwoKICAgIGNvbnN0IGluc2VydEFmdGVyID0gKGRhdGEsIHJlZk5vZGUpID0+IHsKICAgICAgc3RvcmUudmFsdWUuaW5zZXJ0QWZ0ZXIoZGF0YSwgcmVmTm9kZSk7CiAgICB9OwoKICAgIGNvbnN0IGhhbmRsZU5vZGVFeHBhbmQgPSAobm9kZURhdGEsIG5vZGUsIGluc3RhbmNlKSA9PiB7CiAgICAgIGJyb2FkY2FzdEV4cGFuZGVkKG5vZGUpOwogICAgICBjdHguZW1pdCgibm9kZS1leHBhbmQiLCBub2RlRGF0YSwgbm9kZSwgaW5zdGFuY2UpOwogICAgfTsKCiAgICBjb25zdCB1cGRhdGVLZXlDaGlsZHJlbiA9IChrZXksIGRhdGEpID0+IHsKICAgICAgaWYgKCFwcm9wcy5ub2RlS2V5KSB0aHJvdyBuZXcgRXJyb3IoIltUcmVlXSBub2RlS2V5IGlzIHJlcXVpcmVkIGluIHVwZGF0ZUtleUNoaWxkIik7CiAgICAgIHN0b3JlLnZhbHVlLnVwZGF0ZUNoaWxkcmVuKGtleSwgZGF0YSk7CiAgICB9OwoKICAgIHZ1ZS5wcm92aWRlKCJSb290VHJlZSIsIHsKICAgICAgY3R4LAogICAgICBwcm9wcywKICAgICAgc3RvcmUsCiAgICAgIHJvb3QsCiAgICAgIGN1cnJlbnROb2RlLAogICAgICBpbnN0YW5jZTogdnVlLmdldEN1cnJlbnRJbnN0YW5jZSgpCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIHN0b3JlLAogICAgICByb290LAogICAgICBjdXJyZW50Tm9kZSwKICAgICAgZHJhZ1N0YXRlLAogICAgICBlbCQsCiAgICAgIGRyb3BJbmRpY2F0b3IkLAogICAgICBpc0VtcHR5LAogICAgICBmaWx0ZXIsCiAgICAgIGdldE5vZGVLZXk6IGdldE5vZGVLZXkkMSwKICAgICAgZ2V0Tm9kZVBhdGgsCiAgICAgIGdldENoZWNrZWROb2RlcywKICAgICAgZ2V0Q2hlY2tlZEtleXMsCiAgICAgIGdldEN1cnJlbnROb2RlLAogICAgICBnZXRDdXJyZW50S2V5LAogICAgICBzZXRDaGVja2VkTm9kZXMsCiAgICAgIHNldENoZWNrZWRLZXlzLAogICAgICBzZXRDaGVja2VkLAogICAgICBnZXRIYWxmQ2hlY2tlZE5vZGVzLAogICAgICBnZXRIYWxmQ2hlY2tlZEtleXMsCiAgICAgIHNldEN1cnJlbnROb2RlLAogICAgICBzZXRDdXJyZW50S2V5LAogICAgICBnZXROb2RlLAogICAgICByZW1vdmUsCiAgICAgIGFwcGVuZCwKICAgICAgaW5zZXJ0QmVmb3JlLAogICAgICBpbnNlcnRBZnRlciwKICAgICAgaGFuZGxlTm9kZUV4cGFuZCwKICAgICAgdXBkYXRlS2V5Q2hpbGRyZW4KICAgIH07CiAgfQoKfSk7CmNvbnN0IF9ob2lzdGVkXzEkMSA9IHsKICBrZXk6IDAsCiAgY2xhc3M6ICJlbC10cmVlX19lbXB0eS1ibG9jayIKfTsKY29uc3QgX2hvaXN0ZWRfMiA9IHsKICBjbGFzczogImVsLXRyZWVfX2VtcHR5LXRleHQiCn07CmNvbnN0IF9ob2lzdGVkXzMgPSB7CiAgcmVmOiAiZHJvcEluZGljYXRvciQiLAogIGNsYXNzOiAiZWwtdHJlZV9fZHJvcC1pbmRpY2F0b3IiCn07CgpmdW5jdGlvbiByZW5kZXIkMShfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICBjb25zdCBfY29tcG9uZW50X2VsX3RyZWVfbm9kZSA9IHZ1ZS5yZXNvbHZlQ29tcG9uZW50KCJlbC10cmVlLW5vZGUiKTsKCiAgcmV0dXJuIHZ1ZS5vcGVuQmxvY2soKSwgdnVlLmNyZWF0ZUJsb2NrKCJkaXYiLCB7CiAgICByZWY6ICJlbCQiLAogICAgY2xhc3M6IFsiZWwtdHJlZSIsIHsKICAgICAgImVsLXRyZWUtLWhpZ2hsaWdodC1jdXJyZW50IjogX2N0eC5oaWdobGlnaHRDdXJyZW50LAogICAgICAiaXMtZHJhZ2dpbmciOiAhIV9jdHguZHJhZ1N0YXRlLmRyYWdnaW5nTm9kZSwKICAgICAgImlzLWRyb3Atbm90LWFsbG93IjogIV9jdHguZHJhZ1N0YXRlLmFsbG93RHJvcCwKICAgICAgImlzLWRyb3AtaW5uZXIiOiBfY3R4LmRyYWdTdGF0ZS5kcm9wVHlwZSA9PT0gImlubmVyIgogICAgfV0sCiAgICByb2xlOiAidHJlZSIKICB9LCBbKHZ1ZS5vcGVuQmxvY2sodHJ1ZSksIHZ1ZS5jcmVhdGVCbG9jayh2dWUuRnJhZ21lbnQsIG51bGwsIHZ1ZS5yZW5kZXJMaXN0KF9jdHgucm9vdC5jaGlsZE5vZGVzLCBjaGlsZCA9PiB7CiAgICByZXR1cm4gdnVlLm9wZW5CbG9jaygpLCB2dWUuY3JlYXRlQmxvY2soX2NvbXBvbmVudF9lbF90cmVlX25vZGUsIHsKICAgICAga2V5OiBfY3R4LmdldE5vZGVLZXkoY2hpbGQpLAogICAgICBub2RlOiBjaGlsZCwKICAgICAgcHJvcHM6IF9jdHgucHJvcHMsCiAgICAgICJyZW5kZXItYWZ0ZXItZXhwYW5kIjogX2N0eC5yZW5kZXJBZnRlckV4cGFuZCwKICAgICAgInNob3ctY2hlY2tib3giOiBfY3R4LnNob3dDaGVja2JveCwKICAgICAgInJlbmRlci1jb250ZW50IjogX2N0eC5yZW5kZXJDb250ZW50LAogICAgICBvbk5vZGVFeHBhbmQ6IF9jdHguaGFuZGxlTm9kZUV4cGFuZAogICAgfSwgbnVsbCwgOCwgWyJub2RlIiwgInByb3BzIiwgInJlbmRlci1hZnRlci1leHBhbmQiLCAic2hvdy1jaGVja2JveCIsICJyZW5kZXItY29udGVudCIsICJvbk5vZGVFeHBhbmQiXSk7CiAgfSksIDEyOCkpLCBfY3R4LmlzRW1wdHkgPyAodnVlLm9wZW5CbG9jaygpLCB2dWUuY3JlYXRlQmxvY2soImRpdiIsIF9ob2lzdGVkXzEkMSwgW3Z1ZS5jcmVhdGVWTm9kZSgic3BhbiIsIF9ob2lzdGVkXzIsIHZ1ZS50b0Rpc3BsYXlTdHJpbmcoX2N0eC5lbXB0eVRleHQpLCAxKV0pKSA6IHZ1ZS5jcmVhdGVDb21tZW50Vk5vZGUoInYtaWYiLCB0cnVlKSwgdnVlLndpdGhEaXJlY3RpdmVzKHZ1ZS5jcmVhdGVWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMywgbnVsbCwgNTEyKSwgW1t2dWUudlNob3csIF9jdHguZHJhZ1N0YXRlLnNob3dEcm9wSW5kaWNhdG9yXV0pXSwgMik7Cn0KCnNjcmlwdCQyLnJlbmRlciA9IHJlbmRlciQxOwpzY3JpcHQkMi5fX2ZpbGUgPSAicGFja2FnZXMvdHJlZS9zcmMvdHJlZS52dWUiOwoKc2NyaXB0JDIuaW5zdGFsbCA9IGFwcCA9PiB7CiAgYXBwLmNvbXBvbmVudChzY3JpcHQkMi5uYW1lLCBzY3JpcHQkMik7Cn07Cgpjb25zdCBfVHJlZSA9IHNjcmlwdCQyOwpleHBvcnRzLmRlZmF1bHQgPSBfVHJlZTs="},{"version":3,"sources":["C:/Users/multicampus/Desktop/pjt 1 back/cowdog_fe/node_modules/element-plus/lib/el-tree/index.js"],"names":["Object","defineProperty","exports","value","vue","require","ElCollapseTransition","ElCheckbox","mitt","dom","aria","locale","_interopDefaultLegacy","e","ElCollapseTransition__default","ElCheckbox__default","mitt__default","EMPTY_OBJ","process","env","NODE_ENV","freeze","EMPTY_ARR","hasOwnProperty","prototype","hasOwn","val","key","call","NODE_KEY","markNodeData","node","data","id","enumerable","configurable","writable","getNodeKey","getChildState","all","none","allWithoutDisable","i","j","length","n","checked","indeterminate","disabled","half","reInitChecked","childNodes","parent","level","store","checkStrictly","getPropertyFromData","prop","props","config","dataProp","nodeIdSeed","Node","constructor","options","text","expanded","visible","isCurrent","canFocus","name","loaded","loading","initialize","Error","registerNode","isLeaf","isLeafByUser","lazy","setData","defaultExpandAll","expand","Array","isArray","defaultExpandedKeys","indexOf","autoExpandParent","currentNodeKey","currentNode","_initDefaultCheckedNode","updateLeafState","children","insertChild","label","nodeKey","nextSibling","index","previousSibling","contains","target","deep","some","child","remove","removeChild","batch","getChildren","push","splice","assign","reactive","insertBefore","ref","insertAfter","dataIndex","deregisterNode","removeChildByData","targetNode","callback","expandParent","done","forEach","item","shouldLoadData","loadData","setChecked","doCreateChildren","array","defaultProps","collapse","load","recursion","passValue","checkDescendants","handleDescendants","isCheck","all2","forceInit","updateChildren","newData","oldData","map","newDataMap","newNodes","isNodeExists","findIndex","keys","resolve","TreeStore","option","nodesMap","root","loadFn","_initDefaultCheckedNodes","filter","filterNodeMethod","traverse","allHidden","newVal","instanceChanged","getNode","refData","refNode","append","parentData","parentNode","defaultCheckedKeys","checkedKey","setDefaultCheckedKey","getCheckedNodes","leafOnly","includeHalfChecked","checkedNodes","getCheckedKeys","getHalfCheckedNodes","nodes","getHalfCheckedKeys","_getAllNodes","allNodes","_setCheckedKeys","checkedKeys","sort","a","b","cache","create","toString","node2","setCheckedNodes","setCheckedKeys","key2","setDefaultExpandedKeys","getCurrentNode","setCurrentNode","prevCurrentNode","setUserCurrentNode","shouldAutoExpandParent","currNode","setCurrentNodeKey","script","defineComponent","type","required","renderContent","Function","setup","nodeInstance","inject","tree","h","_self","ctx","slots","default","class","__file","useNodeExpandEventBroadcast","parentNodeMap","currentNodeMap","treeNodeExpand","provide","broadcastExpanded","accordion","childNode","useDragNodeHandler","el$","dropIndicator$","emitter","dragState","showDropIndicator","draggingNode","dropNode","allowDrop","dropType","on","event","treeNode","allowDrag","preventDefault","dataTransfer","effectAllowed","emit","oldDropNode","removeClass","$el","dropPrev","dropInner","dropNext","userAllowDropInner","dropEffect","targetPosition","getBoundingClientRect","treePosition","prevPercent","nextPercent","indicatorTop","distance","clientY","top","height","iconPosition","querySelector","dropIndicator","bottom","style","left","right","addClass","draggingNodeCopy","useDragNodeEmitter","script$1","components","NodeContent","renderAfterExpand","Boolean","showCheckbox","emits","childNodeRendered","oldChecked","oldIndeterminate","node$","instance","getCurrentInstance","console","warn","childrenKey","watch","handleSelectChange","nextTick","getNodeKey$1","handleClick","expandOnClickNode","handleExpandIconClick","checkOnClickNode","handleCheckChange","handleContextMenu","vnode","stopPropagation","ev","halfCheckedNodes","halfCheckedKeys","handleChildNodeExpand","nodeData","instance2","handleDragStart","draggable","handleDragOver","handleDrop","handleDragEnd","_hoisted_1","render","_ctx","_cache","$props","$setup","$data","$options","_component_el_checkbox","resolveComponent","_component_node_content","_component_el_tree_node","_component_el_collapse_transition","withDirectives","openBlock","createBlock","role","tabindex","onClick","withModifiers","args","onContextmenu","onDragstart","onDragover","onDragend","onDrop","createVNode","indent","iconClass","onChange","createCommentVNode","withCtx","Fragment","renderList","onNodeExpand","vShow","_","useKeydown","treeItems","checkboxItems","onMounted","initTabIndex","handleKeydown","onBeforeUnmount","off","onUpdated","from","querySelectorAll","checkbox","setAttribute","currentItem","className","code","currentIndex","nextIndex","EVENT_CODE","up","down","startIndex","dataset","focus","click","hasInput","enter","space","_a","checkedItem","script$2","ElTreeNode","emptyText","String","t","Number","highlightCurrent","isEmpty","computed","every","getNodePath","path","reverse","currentNode2","getCurrentKey","setCurrentKey","handleNodeExpand","updateKeyChildren","_hoisted_1$1","_hoisted_2","_hoisted_3","render$1","toDisplayString","install","app","component","_Tree"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nvar vue = require('vue');\r\nvar ElCollapseTransition = require('../el-collapse-transition');\r\nvar ElCheckbox = require('../el-checkbox');\r\nvar mitt = require('mitt');\r\nvar dom = require('../utils/dom');\r\nvar aria = require('../utils/aria');\r\nvar locale = require('../locale');\r\n\r\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\r\n\r\nvar ElCollapseTransition__default = /*#__PURE__*/_interopDefaultLegacy(ElCollapseTransition);\r\nvar ElCheckbox__default = /*#__PURE__*/_interopDefaultLegacy(ElCheckbox);\r\nvar mitt__default = /*#__PURE__*/_interopDefaultLegacy(mitt);\r\n\r\n/**\r\n * Make a map and return a function for checking if a key\r\n * is in that map.\r\n * IMPORTANT: all calls of this function must be prefixed with\r\n * \\/\\*#\\_\\_PURE\\_\\_\\*\\/\r\n * So that rollup can tree-shake them if necessary.\r\n */\r\nconst EMPTY_OBJ = (process.env.NODE_ENV !== 'production')\r\n    ? Object.freeze({})\r\n    : {};\r\nconst EMPTY_ARR = (process.env.NODE_ENV !== 'production') ? Object.freeze([]) : [];\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\r\nconst hasOwn = (val, key) => hasOwnProperty.call(val, key);\r\n\r\nconst NODE_KEY = \"$treeNodeId\";\r\nconst markNodeData = function(node, data) {\r\n  if (!data || data[NODE_KEY])\r\n    return;\r\n  Object.defineProperty(data, NODE_KEY, {\r\n    value: node.id,\r\n    enumerable: false,\r\n    configurable: false,\r\n    writable: false\r\n  });\r\n};\r\nconst getNodeKey = function(key, data) {\r\n  if (!key)\r\n    return data[NODE_KEY];\r\n  return data[key];\r\n};\r\n\r\nconst getChildState = (node) => {\r\n  let all = true;\r\n  let none = true;\r\n  let allWithoutDisable = true;\r\n  for (let i = 0, j = node.length; i < j; i++) {\r\n    const n = node[i];\r\n    if (n.checked !== true || n.indeterminate) {\r\n      all = false;\r\n      if (!n.disabled) {\r\n        allWithoutDisable = false;\r\n      }\r\n    }\r\n    if (n.checked !== false || n.indeterminate) {\r\n      none = false;\r\n    }\r\n  }\r\n  return { all, none, allWithoutDisable, half: !all && !none };\r\n};\r\nconst reInitChecked = function(node) {\r\n  if (node.childNodes.length === 0)\r\n    return;\r\n  const { all, none, half } = getChildState(node.childNodes);\r\n  if (all) {\r\n    node.checked = true;\r\n    node.indeterminate = false;\r\n  } else if (half) {\r\n    node.checked = false;\r\n    node.indeterminate = true;\r\n  } else if (none) {\r\n    node.checked = false;\r\n    node.indeterminate = false;\r\n  }\r\n  const parent = node.parent;\r\n  if (!parent || parent.level === 0)\r\n    return;\r\n  if (!node.store.checkStrictly) {\r\n    reInitChecked(parent);\r\n  }\r\n};\r\nconst getPropertyFromData = function(node, prop) {\r\n  const props = node.store.props;\r\n  const data = node.data || {};\r\n  const config = props[prop];\r\n  if (typeof config === \"function\") {\r\n    return config(data, node);\r\n  } else if (typeof config === \"string\") {\r\n    return data[config];\r\n  } else if (typeof config === \"undefined\") {\r\n    const dataProp = data[prop];\r\n    return dataProp === void 0 ? \"\" : dataProp;\r\n  }\r\n};\r\nlet nodeIdSeed = 0;\r\nclass Node {\r\n  constructor(options) {\r\n    this.id = nodeIdSeed++;\r\n    this.text = null;\r\n    this.checked = false;\r\n    this.indeterminate = false;\r\n    this.data = null;\r\n    this.expanded = false;\r\n    this.parent = null;\r\n    this.visible = true;\r\n    this.isCurrent = false;\r\n    this.canFocus = false;\r\n    for (const name in options) {\r\n      if (hasOwn(options, name)) {\r\n        this[name] = options[name];\r\n      }\r\n    }\r\n    this.level = 0;\r\n    this.loaded = false;\r\n    this.childNodes = [];\r\n    this.loading = false;\r\n    if (this.parent) {\r\n      this.level = this.parent.level + 1;\r\n    }\r\n  }\r\n  initialize() {\r\n    const store = this.store;\r\n    if (!store) {\r\n      throw new Error(\"[Node]store is required!\");\r\n    }\r\n    store.registerNode(this);\r\n    const props = store.props;\r\n    if (props && typeof props.isLeaf !== \"undefined\") {\r\n      const isLeaf = getPropertyFromData(this, \"isLeaf\");\r\n      if (typeof isLeaf === \"boolean\") {\r\n        this.isLeafByUser = isLeaf;\r\n      }\r\n    }\r\n    if (store.lazy !== true && this.data) {\r\n      this.setData(this.data);\r\n      if (store.defaultExpandAll) {\r\n        this.expanded = true;\r\n        this.canFocus = true;\r\n      }\r\n    } else if (this.level > 0 && store.lazy && store.defaultExpandAll) {\r\n      this.expand();\r\n    }\r\n    if (!Array.isArray(this.data)) {\r\n      markNodeData(this, this.data);\r\n    }\r\n    if (!this.data)\r\n      return;\r\n    const defaultExpandedKeys = store.defaultExpandedKeys;\r\n    const key = store.key;\r\n    if (key && defaultExpandedKeys && defaultExpandedKeys.indexOf(this.key) !== -1) {\r\n      this.expand(null, store.autoExpandParent);\r\n    }\r\n    if (key && store.currentNodeKey !== void 0 && this.key === store.currentNodeKey) {\r\n      store.currentNode = this;\r\n      store.currentNode.isCurrent = true;\r\n    }\r\n    if (store.lazy) {\r\n      store._initDefaultCheckedNode(this);\r\n    }\r\n    this.updateLeafState();\r\n    if (this.parent && (this.level === 1 || this.parent.expanded === true))\r\n      this.canFocus = true;\r\n  }\r\n  setData(data) {\r\n    if (!Array.isArray(data)) {\r\n      markNodeData(this, data);\r\n    }\r\n    this.data = data;\r\n    this.childNodes = [];\r\n    let children;\r\n    if (this.level === 0 && this.data instanceof Array) {\r\n      children = this.data;\r\n    } else {\r\n      children = getPropertyFromData(this, \"children\") || [];\r\n    }\r\n    for (let i = 0, j = children.length; i < j; i++) {\r\n      this.insertChild({ data: children[i] });\r\n    }\r\n  }\r\n  get label() {\r\n    return getPropertyFromData(this, \"label\");\r\n  }\r\n  get key() {\r\n    const nodeKey = this.store.key;\r\n    if (this.data)\r\n      return this.data[nodeKey];\r\n    return null;\r\n  }\r\n  get disabled() {\r\n    return getPropertyFromData(this, \"disabled\");\r\n  }\r\n  get nextSibling() {\r\n    const parent = this.parent;\r\n    if (parent) {\r\n      const index = parent.childNodes.indexOf(this);\r\n      if (index > -1) {\r\n        return parent.childNodes[index + 1];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  get previousSibling() {\r\n    const parent = this.parent;\r\n    if (parent) {\r\n      const index = parent.childNodes.indexOf(this);\r\n      if (index > -1) {\r\n        return index > 0 ? parent.childNodes[index - 1] : null;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  contains(target, deep = true) {\r\n    return (this.childNodes || []).some((child) => child === target || deep && child.contains(target));\r\n  }\r\n  remove() {\r\n    const parent = this.parent;\r\n    if (parent) {\r\n      parent.removeChild(this);\r\n    }\r\n  }\r\n  insertChild(child, index, batch) {\r\n    if (!child)\r\n      throw new Error(\"insertChild error: child is required.\");\r\n    if (!(child instanceof Node)) {\r\n      if (!batch) {\r\n        const children = this.getChildren(true);\r\n        if (children.indexOf(child.data) === -1) {\r\n          if (typeof index === \"undefined\" || index < 0) {\r\n            children.push(child.data);\r\n          } else {\r\n            children.splice(index, 0, child.data);\r\n          }\r\n        }\r\n      }\r\n      Object.assign(child, {\r\n        parent: this,\r\n        store: this.store\r\n      });\r\n      child = vue.reactive(new Node(child));\r\n      if (child instanceof Node) {\r\n        child.initialize();\r\n      }\r\n    }\r\n    child.level = this.level + 1;\r\n    if (typeof index === \"undefined\" || index < 0) {\r\n      this.childNodes.push(child);\r\n    } else {\r\n      this.childNodes.splice(index, 0, child);\r\n    }\r\n    this.updateLeafState();\r\n  }\r\n  insertBefore(child, ref) {\r\n    let index;\r\n    if (ref) {\r\n      index = this.childNodes.indexOf(ref);\r\n    }\r\n    this.insertChild(child, index);\r\n  }\r\n  insertAfter(child, ref) {\r\n    let index;\r\n    if (ref) {\r\n      index = this.childNodes.indexOf(ref);\r\n      if (index !== -1)\r\n        index += 1;\r\n    }\r\n    this.insertChild(child, index);\r\n  }\r\n  removeChild(child) {\r\n    const children = this.getChildren() || [];\r\n    const dataIndex = children.indexOf(child.data);\r\n    if (dataIndex > -1) {\r\n      children.splice(dataIndex, 1);\r\n    }\r\n    const index = this.childNodes.indexOf(child);\r\n    if (index > -1) {\r\n      this.store && this.store.deregisterNode(child);\r\n      child.parent = null;\r\n      this.childNodes.splice(index, 1);\r\n    }\r\n    this.updateLeafState();\r\n  }\r\n  removeChildByData(data) {\r\n    let targetNode = null;\r\n    for (let i = 0; i < this.childNodes.length; i++) {\r\n      if (this.childNodes[i].data === data) {\r\n        targetNode = this.childNodes[i];\r\n        break;\r\n      }\r\n    }\r\n    if (targetNode) {\r\n      this.removeChild(targetNode);\r\n    }\r\n  }\r\n  expand(callback, expandParent) {\r\n    const done = () => {\r\n      if (expandParent) {\r\n        let parent = this.parent;\r\n        while (parent.level > 0) {\r\n          parent.expanded = true;\r\n          parent = parent.parent;\r\n        }\r\n      }\r\n      this.expanded = true;\r\n      if (callback)\r\n        callback();\r\n      this.childNodes.forEach((item) => {\r\n        item.canFocus = true;\r\n      });\r\n    };\r\n    if (this.shouldLoadData()) {\r\n      this.loadData((data) => {\r\n        if (Array.isArray(data)) {\r\n          if (this.checked) {\r\n            this.setChecked(true, true);\r\n          } else if (!this.store.checkStrictly) {\r\n            reInitChecked(this);\r\n          }\r\n          done();\r\n        }\r\n      });\r\n    } else {\r\n      done();\r\n    }\r\n  }\r\n  doCreateChildren(array, defaultProps = {}) {\r\n    array.forEach((item) => {\r\n      this.insertChild(Object.assign({ data: item }, defaultProps), void 0, true);\r\n    });\r\n  }\r\n  collapse() {\r\n    this.expanded = false;\r\n    this.childNodes.forEach((item) => {\r\n      item.canFocus = false;\r\n    });\r\n  }\r\n  shouldLoadData() {\r\n    return this.store.lazy === true && this.store.load && !this.loaded;\r\n  }\r\n  updateLeafState() {\r\n    if (this.store.lazy === true && this.loaded !== true && typeof this.isLeafByUser !== \"undefined\") {\r\n      this.isLeaf = this.isLeafByUser;\r\n      return;\r\n    }\r\n    const childNodes = this.childNodes;\r\n    if (!this.store.lazy || this.store.lazy === true && this.loaded === true) {\r\n      this.isLeaf = !childNodes || childNodes.length === 0;\r\n      return;\r\n    }\r\n    this.isLeaf = false;\r\n  }\r\n  setChecked(value, deep, recursion, passValue) {\r\n    this.indeterminate = value === \"half\";\r\n    this.checked = value === true;\r\n    if (this.store.checkStrictly)\r\n      return;\r\n    if (!(this.shouldLoadData() && !this.store.checkDescendants)) {\r\n      const { all, allWithoutDisable } = getChildState(this.childNodes);\r\n      if (!this.isLeaf && (!all && allWithoutDisable)) {\r\n        this.checked = false;\r\n        value = false;\r\n      }\r\n      const handleDescendants = () => {\r\n        if (deep) {\r\n          const childNodes = this.childNodes;\r\n          for (let i = 0, j = childNodes.length; i < j; i++) {\r\n            const child = childNodes[i];\r\n            passValue = passValue || value !== false;\r\n            const isCheck = child.disabled ? child.checked : passValue;\r\n            child.setChecked(isCheck, deep, true, passValue);\r\n          }\r\n          const { half, all: all2 } = getChildState(childNodes);\r\n          if (!all2) {\r\n            this.checked = all2;\r\n            this.indeterminate = half;\r\n          }\r\n        }\r\n      };\r\n      if (this.shouldLoadData()) {\r\n        this.loadData(() => {\r\n          handleDescendants();\r\n          reInitChecked(this);\r\n        }, {\r\n          checked: value !== false\r\n        });\r\n        return;\r\n      } else {\r\n        handleDescendants();\r\n      }\r\n    }\r\n    const parent = this.parent;\r\n    if (!parent || parent.level === 0)\r\n      return;\r\n    if (!recursion) {\r\n      reInitChecked(parent);\r\n    }\r\n  }\r\n  getChildren(forceInit = false) {\r\n    if (this.level === 0)\r\n      return this.data;\r\n    const data = this.data;\r\n    if (!data)\r\n      return null;\r\n    const props = this.store.props;\r\n    let children = \"children\";\r\n    if (props) {\r\n      children = props.children || \"children\";\r\n    }\r\n    if (data[children] === void 0) {\r\n      data[children] = null;\r\n    }\r\n    if (forceInit && !data[children]) {\r\n      data[children] = [];\r\n    }\r\n    return data[children];\r\n  }\r\n  updateChildren() {\r\n    const newData = this.getChildren() || [];\r\n    const oldData = this.childNodes.map((node) => node.data);\r\n    const newDataMap = {};\r\n    const newNodes = [];\r\n    newData.forEach((item, index) => {\r\n      const key = item[NODE_KEY];\r\n      const isNodeExists = !!key && oldData.findIndex((data) => data[NODE_KEY] === key) >= 0;\r\n      if (isNodeExists) {\r\n        newDataMap[key] = { index, data: item };\r\n      } else {\r\n        newNodes.push({ index, data: item });\r\n      }\r\n    });\r\n    if (!this.store.lazy) {\r\n      oldData.forEach((item) => {\r\n        if (!newDataMap[item[NODE_KEY]])\r\n          this.removeChildByData(item);\r\n      });\r\n    }\r\n    newNodes.forEach(({ index, data }) => {\r\n      this.insertChild({ data }, index);\r\n    });\r\n    this.updateLeafState();\r\n  }\r\n  loadData(callback, defaultProps = {}) {\r\n    if (this.store.lazy === true && this.store.load && !this.loaded && (!this.loading || Object.keys(defaultProps).length)) {\r\n      this.loading = true;\r\n      const resolve = (children) => {\r\n        this.loaded = true;\r\n        this.loading = false;\r\n        this.childNodes = [];\r\n        this.doCreateChildren(children, defaultProps);\r\n        this.updateLeafState();\r\n        if (callback) {\r\n          callback.call(this, children);\r\n        }\r\n      };\r\n      this.store.load(this, resolve);\r\n    } else {\r\n      if (callback) {\r\n        callback.call(this);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nclass TreeStore {\r\n  constructor(options) {\r\n    this.currentNode = null;\r\n    this.currentNodeKey = null;\r\n    for (const option in options) {\r\n      if (hasOwn(options, option)) {\r\n        this[option] = options[option];\r\n      }\r\n    }\r\n    this.nodesMap = {};\r\n  }\r\n  initialize() {\r\n    this.root = new Node({\r\n      data: this.data,\r\n      store: this\r\n    });\r\n    this.root.initialize();\r\n    if (this.lazy && this.load) {\r\n      const loadFn = this.load;\r\n      loadFn(this.root, (data) => {\r\n        this.root.doCreateChildren(data);\r\n        this._initDefaultCheckedNodes();\r\n      });\r\n    } else {\r\n      this._initDefaultCheckedNodes();\r\n    }\r\n  }\r\n  filter(value) {\r\n    const filterNodeMethod = this.filterNodeMethod;\r\n    const lazy = this.lazy;\r\n    const traverse = function(node) {\r\n      const childNodes = node.root ? node.root.childNodes : node.childNodes;\r\n      childNodes.forEach((child) => {\r\n        child.visible = filterNodeMethod.call(child, value, child.data, child);\r\n        traverse(child);\r\n      });\r\n      if (!node.visible && childNodes.length) {\r\n        let allHidden = true;\r\n        allHidden = !childNodes.some((child) => child.visible);\r\n        if (node.root) {\r\n          node.root.visible = allHidden === false;\r\n        } else {\r\n          node.visible = allHidden === false;\r\n        }\r\n      }\r\n      if (!value)\r\n        return;\r\n      if (node.visible && !node.isLeaf && !lazy)\r\n        node.expand();\r\n    };\r\n    traverse(this);\r\n  }\r\n  setData(newVal) {\r\n    const instanceChanged = newVal !== this.root.data;\r\n    if (instanceChanged) {\r\n      this.root.setData(newVal);\r\n      this._initDefaultCheckedNodes();\r\n    } else {\r\n      this.root.updateChildren();\r\n    }\r\n  }\r\n  getNode(data) {\r\n    if (data instanceof Node)\r\n      return data;\r\n    const key = typeof data !== \"object\" ? data : getNodeKey(this.key, data);\r\n    return this.nodesMap[key] || null;\r\n  }\r\n  insertBefore(data, refData) {\r\n    const refNode = this.getNode(refData);\r\n    refNode.parent.insertBefore({ data }, refNode);\r\n  }\r\n  insertAfter(data, refData) {\r\n    const refNode = this.getNode(refData);\r\n    refNode.parent.insertAfter({ data }, refNode);\r\n  }\r\n  remove(data) {\r\n    const node = this.getNode(data);\r\n    if (node && node.parent) {\r\n      if (node === this.currentNode) {\r\n        this.currentNode = null;\r\n      }\r\n      node.parent.removeChild(node);\r\n    }\r\n  }\r\n  append(data, parentData) {\r\n    const parentNode = parentData ? this.getNode(parentData) : this.root;\r\n    if (parentNode) {\r\n      parentNode.insertChild({ data });\r\n    }\r\n  }\r\n  _initDefaultCheckedNodes() {\r\n    const defaultCheckedKeys = this.defaultCheckedKeys || [];\r\n    const nodesMap = this.nodesMap;\r\n    defaultCheckedKeys.forEach((checkedKey) => {\r\n      const node = nodesMap[checkedKey];\r\n      if (node) {\r\n        node.setChecked(true, !this.checkStrictly);\r\n      }\r\n    });\r\n  }\r\n  _initDefaultCheckedNode(node) {\r\n    const defaultCheckedKeys = this.defaultCheckedKeys || [];\r\n    if (defaultCheckedKeys.indexOf(node.key) !== -1) {\r\n      node.setChecked(true, !this.checkStrictly);\r\n    }\r\n  }\r\n  setDefaultCheckedKey(newVal) {\r\n    if (newVal !== this.defaultCheckedKeys) {\r\n      this.defaultCheckedKeys = newVal;\r\n      this._initDefaultCheckedNodes();\r\n    }\r\n  }\r\n  registerNode(node) {\r\n    const key = this.key;\r\n    if (!node || !node.data)\r\n      return;\r\n    if (!key) {\r\n      this.nodesMap[node.id] = node;\r\n    } else {\r\n      const nodeKey = node.key;\r\n      if (nodeKey !== void 0)\r\n        this.nodesMap[node.key] = node;\r\n    }\r\n  }\r\n  deregisterNode(node) {\r\n    const key = this.key;\r\n    if (!key || !node || !node.data)\r\n      return;\r\n    node.childNodes.forEach((child) => {\r\n      this.deregisterNode(child);\r\n    });\r\n    delete this.nodesMap[node.key];\r\n  }\r\n  getCheckedNodes(leafOnly = false, includeHalfChecked = false) {\r\n    const checkedNodes = [];\r\n    const traverse = function(node) {\r\n      const childNodes = node.root ? node.root.childNodes : node.childNodes;\r\n      childNodes.forEach((child) => {\r\n        if ((child.checked || includeHalfChecked && child.indeterminate) && (!leafOnly || leafOnly && child.isLeaf)) {\r\n          checkedNodes.push(child.data);\r\n        }\r\n        traverse(child);\r\n      });\r\n    };\r\n    traverse(this);\r\n    return checkedNodes;\r\n  }\r\n  getCheckedKeys(leafOnly = false) {\r\n    return this.getCheckedNodes(leafOnly).map((data) => (data || {})[this.key]);\r\n  }\r\n  getHalfCheckedNodes() {\r\n    const nodes = [];\r\n    const traverse = function(node) {\r\n      const childNodes = node.root ? node.root.childNodes : node.childNodes;\r\n      childNodes.forEach((child) => {\r\n        if (child.indeterminate) {\r\n          nodes.push(child.data);\r\n        }\r\n        traverse(child);\r\n      });\r\n    };\r\n    traverse(this);\r\n    return nodes;\r\n  }\r\n  getHalfCheckedKeys() {\r\n    return this.getHalfCheckedNodes().map((data) => (data || {})[this.key]);\r\n  }\r\n  _getAllNodes() {\r\n    const allNodes = [];\r\n    const nodesMap = this.nodesMap;\r\n    for (const nodeKey in nodesMap) {\r\n      if (hasOwn(nodesMap, nodeKey)) {\r\n        allNodes.push(nodesMap[nodeKey]);\r\n      }\r\n    }\r\n    return allNodes;\r\n  }\r\n  updateChildren(key, data) {\r\n    const node = this.nodesMap[key];\r\n    if (!node)\r\n      return;\r\n    const childNodes = node.childNodes;\r\n    for (let i = childNodes.length - 1; i >= 0; i--) {\r\n      const child = childNodes[i];\r\n      this.remove(child.data);\r\n    }\r\n    for (let i = 0, j = data.length; i < j; i++) {\r\n      const child = data[i];\r\n      this.append(child, node.data);\r\n    }\r\n  }\r\n  _setCheckedKeys(key, leafOnly = false, checkedKeys) {\r\n    const allNodes = this._getAllNodes().sort((a, b) => b.level - a.level);\r\n    const cache = Object.create(null);\r\n    const keys = Object.keys(checkedKeys);\r\n    allNodes.forEach((node) => node.setChecked(false, false));\r\n    for (let i = 0, j = allNodes.length; i < j; i++) {\r\n      const node = allNodes[i];\r\n      const nodeKey = node.data[key].toString();\r\n      const checked = keys.indexOf(nodeKey) > -1;\r\n      if (!checked) {\r\n        if (node.checked && !cache[nodeKey]) {\r\n          node.setChecked(false, false);\r\n        }\r\n        continue;\r\n      }\r\n      let parent = node.parent;\r\n      while (parent && parent.level > 0) {\r\n        cache[parent.data[key]] = true;\r\n        parent = parent.parent;\r\n      }\r\n      if (node.isLeaf || this.checkStrictly) {\r\n        node.setChecked(true, false);\r\n        continue;\r\n      }\r\n      node.setChecked(true, true);\r\n      if (leafOnly) {\r\n        node.setChecked(false, false);\r\n        const traverse = function(node2) {\r\n          const childNodes = node2.childNodes;\r\n          childNodes.forEach((child) => {\r\n            if (!child.isLeaf) {\r\n              child.setChecked(false, false);\r\n            }\r\n            traverse(child);\r\n          });\r\n        };\r\n        traverse(node);\r\n      }\r\n    }\r\n  }\r\n  setCheckedNodes(array, leafOnly = false) {\r\n    const key = this.key;\r\n    const checkedKeys = {};\r\n    array.forEach((item) => {\r\n      checkedKeys[(item || {})[key]] = true;\r\n    });\r\n    this._setCheckedKeys(key, leafOnly, checkedKeys);\r\n  }\r\n  setCheckedKeys(keys, leafOnly = false) {\r\n    this.defaultCheckedKeys = keys;\r\n    const key = this.key;\r\n    const checkedKeys = {};\r\n    keys.forEach((key2) => {\r\n      checkedKeys[key2] = true;\r\n    });\r\n    this._setCheckedKeys(key, leafOnly, checkedKeys);\r\n  }\r\n  setDefaultExpandedKeys(keys) {\r\n    keys = keys || [];\r\n    this.defaultExpandedKeys = keys;\r\n    keys.forEach((key) => {\r\n      const node = this.getNode(key);\r\n      if (node)\r\n        node.expand(null, this.autoExpandParent);\r\n    });\r\n  }\r\n  setChecked(data, checked, deep) {\r\n    const node = this.getNode(data);\r\n    if (node) {\r\n      node.setChecked(!!checked, deep);\r\n    }\r\n  }\r\n  getCurrentNode() {\r\n    return this.currentNode;\r\n  }\r\n  setCurrentNode(currentNode) {\r\n    const prevCurrentNode = this.currentNode;\r\n    if (prevCurrentNode) {\r\n      prevCurrentNode.isCurrent = false;\r\n    }\r\n    this.currentNode = currentNode;\r\n    this.currentNode.isCurrent = true;\r\n  }\r\n  setUserCurrentNode(node, shouldAutoExpandParent = true) {\r\n    const key = node[this.key];\r\n    const currNode = this.nodesMap[key];\r\n    this.setCurrentNode(currNode);\r\n    if (shouldAutoExpandParent && this.currentNode.level > 1) {\r\n      this.currentNode.parent.expand(null, true);\r\n    }\r\n  }\r\n  setCurrentNodeKey(key, shouldAutoExpandParent = true) {\r\n    if (key === null || key === void 0) {\r\n      this.currentNode && (this.currentNode.isCurrent = false);\r\n      this.currentNode = null;\r\n      return;\r\n    }\r\n    const node = this.getNode(key);\r\n    if (node) {\r\n      this.setCurrentNode(node);\r\n      if (shouldAutoExpandParent && this.currentNode.level > 1) {\r\n        this.currentNode.parent.expand(null, true);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nvar script = vue.defineComponent({\r\n  name: \"ElTreeNodeContent\",\r\n  props: {\r\n    node: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    renderContent: Function\r\n  },\r\n  setup(props) {\r\n    const nodeInstance = vue.inject(\"NodeInstance\");\r\n    const tree = vue.inject(\"RootTree\");\r\n    return () => {\r\n      const node = props.node;\r\n      const { data, store } = node;\r\n      return props.renderContent ? props.renderContent(vue.h, { _self: nodeInstance, node, data, store }) : tree.ctx.slots.default ? tree.ctx.slots.default({ node, data }) : vue.h(\"span\", { class: \"el-tree-node__label\" }, [node.label]);\r\n    };\r\n  }\r\n});\r\n\r\nscript.__file = \"packages/tree/src/tree-node-content.vue\";\r\n\r\nfunction useNodeExpandEventBroadcast(props) {\r\n  const parentNodeMap = vue.inject(\"TreeNodeMap\", null);\r\n  const currentNodeMap = {\r\n    treeNodeExpand: (node) => {\r\n      if (props.node !== node) {\r\n        props.node.collapse();\r\n      }\r\n    },\r\n    children: []\r\n  };\r\n  if (parentNodeMap) {\r\n    parentNodeMap.children.push(currentNodeMap);\r\n  }\r\n  vue.provide(\"TreeNodeMap\", currentNodeMap);\r\n  return {\r\n    broadcastExpanded: (node) => {\r\n      if (!props.accordion)\r\n        return;\r\n      for (const childNode of currentNodeMap.children) {\r\n        childNode.treeNodeExpand(node);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction useDragNodeHandler({ props, ctx, el$, dropIndicator$, store }) {\r\n  const emitter = mitt__default['default']();\r\n  vue.provide(\"DragNodeEmitter\", emitter);\r\n  const dragState = vue.ref({\r\n    showDropIndicator: false,\r\n    draggingNode: null,\r\n    dropNode: null,\r\n    allowDrop: true,\r\n    dropType: null\r\n  });\r\n  emitter.on(\"tree-node-drag-start\", ({ event, treeNode }) => {\r\n    if (typeof props.allowDrag === \"function\" && !props.allowDrag(treeNode.node)) {\r\n      event.preventDefault();\r\n      return false;\r\n    }\r\n    event.dataTransfer.effectAllowed = \"move\";\r\n    try {\r\n      event.dataTransfer.setData(\"text/plain\", \"\");\r\n    } catch (e) {\r\n    }\r\n    dragState.value.draggingNode = treeNode;\r\n    ctx.emit(\"node-drag-start\", treeNode.node, event);\r\n  });\r\n  emitter.on(\"tree-node-drag-over\", ({ event, treeNode }) => {\r\n    const dropNode = treeNode;\r\n    const oldDropNode = dragState.value.dropNode;\r\n    if (oldDropNode && oldDropNode !== dropNode) {\r\n      dom.removeClass(oldDropNode.$el, \"is-drop-inner\");\r\n    }\r\n    const draggingNode = dragState.value.draggingNode;\r\n    if (!draggingNode || !dropNode)\r\n      return;\r\n    let dropPrev = true;\r\n    let dropInner = true;\r\n    let dropNext = true;\r\n    let userAllowDropInner = true;\r\n    if (typeof props.allowDrop === \"function\") {\r\n      dropPrev = props.allowDrop(draggingNode.node, dropNode.node, \"prev\");\r\n      userAllowDropInner = dropInner = props.allowDrop(draggingNode.node, dropNode.node, \"inner\");\r\n      dropNext = props.allowDrop(draggingNode.node, dropNode.node, \"next\");\r\n    }\r\n    event.dataTransfer.dropEffect = dropInner ? \"move\" : \"none\";\r\n    if ((dropPrev || dropInner || dropNext) && oldDropNode !== dropNode) {\r\n      if (oldDropNode) {\r\n        ctx.emit(\"node-drag-leave\", draggingNode.node, oldDropNode.node, event);\r\n      }\r\n      ctx.emit(\"node-drag-enter\", draggingNode.node, dropNode.node, event);\r\n    }\r\n    if (dropPrev || dropInner || dropNext) {\r\n      dragState.value.dropNode = dropNode;\r\n    }\r\n    if (dropNode.node.nextSibling === draggingNode.node) {\r\n      dropNext = false;\r\n    }\r\n    if (dropNode.node.previousSibling === draggingNode.node) {\r\n      dropPrev = false;\r\n    }\r\n    if (dropNode.node.contains(draggingNode.node, false)) {\r\n      dropInner = false;\r\n    }\r\n    if (draggingNode.node === dropNode.node || draggingNode.node.contains(dropNode.node)) {\r\n      dropPrev = false;\r\n      dropInner = false;\r\n      dropNext = false;\r\n    }\r\n    const targetPosition = dropNode.$el.getBoundingClientRect();\r\n    const treePosition = el$.value.getBoundingClientRect();\r\n    let dropType;\r\n    const prevPercent = dropPrev ? dropInner ? 0.25 : dropNext ? 0.45 : 1 : -1;\r\n    const nextPercent = dropNext ? dropInner ? 0.75 : dropPrev ? 0.55 : 0 : 1;\r\n    let indicatorTop = -9999;\r\n    const distance = event.clientY - targetPosition.top;\r\n    if (distance < targetPosition.height * prevPercent) {\r\n      dropType = \"before\";\r\n    } else if (distance > targetPosition.height * nextPercent) {\r\n      dropType = \"after\";\r\n    } else if (dropInner) {\r\n      dropType = \"inner\";\r\n    } else {\r\n      dropType = \"none\";\r\n    }\r\n    const iconPosition = dropNode.$el.querySelector(\".el-tree-node__expand-icon\").getBoundingClientRect();\r\n    const dropIndicator = dropIndicator$.value;\r\n    if (dropType === \"before\") {\r\n      indicatorTop = iconPosition.top - treePosition.top;\r\n    } else if (dropType === \"after\") {\r\n      indicatorTop = iconPosition.bottom - treePosition.top;\r\n    }\r\n    dropIndicator.style.top = indicatorTop + \"px\";\r\n    dropIndicator.style.left = iconPosition.right - treePosition.left + \"px\";\r\n    if (dropType === \"inner\") {\r\n      dom.addClass(dropNode.$el, \"is-drop-inner\");\r\n    } else {\r\n      dom.removeClass(dropNode.$el, \"is-drop-inner\");\r\n    }\r\n    dragState.value.showDropIndicator = dropType === \"before\" || dropType === \"after\";\r\n    dragState.value.allowDrop = dragState.value.showDropIndicator || userAllowDropInner;\r\n    dragState.value.dropType = dropType;\r\n    ctx.emit(\"node-drag-over\", draggingNode.node, dropNode.node, event);\r\n  });\r\n  emitter.on(\"tree-node-drag-end\", (event) => {\r\n    const { draggingNode, dropType, dropNode } = dragState.value;\r\n    event.preventDefault();\r\n    event.dataTransfer.dropEffect = \"move\";\r\n    if (draggingNode && dropNode) {\r\n      const draggingNodeCopy = { data: draggingNode.node.data };\r\n      if (dropType !== \"none\") {\r\n        draggingNode.node.remove();\r\n      }\r\n      if (dropType === \"before\") {\r\n        dropNode.node.parent.insertBefore(draggingNodeCopy, dropNode.node);\r\n      } else if (dropType === \"after\") {\r\n        dropNode.node.parent.insertAfter(draggingNodeCopy, dropNode.node);\r\n      } else if (dropType === \"inner\") {\r\n        dropNode.node.insertChild(draggingNodeCopy);\r\n      }\r\n      if (dropType !== \"none\") {\r\n        store.value.registerNode(draggingNodeCopy);\r\n      }\r\n      dom.removeClass(dropNode.$el, \"is-drop-inner\");\r\n      ctx.emit(\"node-drag-end\", draggingNode.node, dropNode.node, dropType, event);\r\n      if (dropType !== \"none\") {\r\n        ctx.emit(\"node-drop\", draggingNode.node, dropNode.node, dropType, event);\r\n      }\r\n    }\r\n    if (draggingNode && !dropNode) {\r\n      ctx.emit(\"node-drag-end\", draggingNode.node, null, dropType, event);\r\n    }\r\n    dragState.value.showDropIndicator = false;\r\n    dragState.value.draggingNode = null;\r\n    dragState.value.dropNode = null;\r\n    dragState.value.allowDrop = true;\r\n  });\r\n  return {\r\n    dragState\r\n  };\r\n}\r\nfunction useDragNodeEmitter() {\r\n  const emitter = vue.inject(\"DragNodeEmitter\");\r\n  return {\r\n    emitter\r\n  };\r\n}\r\n\r\nvar script$1 = vue.defineComponent({\r\n  name: \"ElTreeNode\",\r\n  components: {\r\n    ElCollapseTransition: ElCollapseTransition__default['default'],\r\n    ElCheckbox: ElCheckbox__default['default'],\r\n    NodeContent: script\r\n  },\r\n  props: {\r\n    node: {\r\n      type: Node,\r\n      default: () => ({})\r\n    },\r\n    props: {\r\n      type: Object,\r\n      default: () => ({})\r\n    },\r\n    renderContent: Function,\r\n    renderAfterExpand: Boolean,\r\n    showCheckbox: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: [\"node-expand\"],\r\n  setup(props, ctx) {\r\n    const { broadcastExpanded } = useNodeExpandEventBroadcast(props);\r\n    const tree = vue.inject(\"RootTree\");\r\n    const expanded = vue.ref(false);\r\n    const childNodeRendered = vue.ref(false);\r\n    const oldChecked = vue.ref(null);\r\n    const oldIndeterminate = vue.ref(null);\r\n    const node$ = vue.ref(null);\r\n    const { emitter } = useDragNodeEmitter();\r\n    const instance = vue.getCurrentInstance();\r\n    vue.provide(\"NodeInstance\", instance);\r\n    if (!tree) {\r\n      console.warn(\"Can not find node's tree.\");\r\n    }\r\n    if (props.node.expanded) {\r\n      expanded.value = true;\r\n      childNodeRendered.value = true;\r\n    }\r\n    const childrenKey = tree.props[\"children\"] || \"children\";\r\n    vue.watch(() => {\r\n      const children = props.node.data[childrenKey];\r\n      return children && [...children];\r\n    }, () => {\r\n      props.node.updateChildren();\r\n    });\r\n    vue.watch(() => props.node.indeterminate, (val) => {\r\n      handleSelectChange(props.node.checked, val);\r\n    });\r\n    vue.watch(() => props.node.checked, (val) => {\r\n      handleSelectChange(val, props.node.indeterminate);\r\n    });\r\n    vue.watch(() => props.node.expanded, (val) => {\r\n      vue.nextTick(() => expanded.value = val);\r\n      if (val) {\r\n        childNodeRendered.value = true;\r\n      }\r\n    });\r\n    const getNodeKey$1 = (node) => {\r\n      return getNodeKey(tree.props.nodeKey, node.data);\r\n    };\r\n    const handleSelectChange = (checked, indeterminate) => {\r\n      if (oldChecked.value !== checked || oldIndeterminate.value !== indeterminate) {\r\n        tree.ctx.emit(\"check-change\", props.node.data, checked, indeterminate);\r\n      }\r\n      oldChecked.value = checked;\r\n      oldIndeterminate.value = indeterminate;\r\n    };\r\n    const handleClick = () => {\r\n      const store = tree.store.value;\r\n      store.setCurrentNode(props.node);\r\n      tree.ctx.emit(\"current-change\", store.currentNode ? store.currentNode.data : null, store.currentNode);\r\n      tree.currentNode.value = props.node;\r\n      if (tree.props.expandOnClickNode) {\r\n        handleExpandIconClick();\r\n      }\r\n      if (tree.props.checkOnClickNode && !props.node.disabled) {\r\n        handleCheckChange(null, {\r\n          target: { checked: !props.node.checked }\r\n        });\r\n      }\r\n      tree.ctx.emit(\"node-click\", props.node.data, props.node, instance);\r\n    };\r\n    const handleContextMenu = (event) => {\r\n      if (tree.instance.vnode.props[\"onNodeContextmenu\"]) {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      }\r\n      tree.ctx.emit(\"node-contextmenu\", event, props.node.data, props.node, instance);\r\n    };\r\n    const handleExpandIconClick = () => {\r\n      if (props.node.isLeaf)\r\n        return;\r\n      if (expanded.value) {\r\n        tree.ctx.emit(\"node-collapse\", props.node.data, props.node, instance);\r\n        props.node.collapse();\r\n      } else {\r\n        props.node.expand();\r\n        ctx.emit(\"node-expand\", props.node.data, props.node, instance);\r\n      }\r\n    };\r\n    const handleCheckChange = (value, ev) => {\r\n      props.node.setChecked(ev.target.checked, !tree.props.checkStrictly);\r\n      vue.nextTick(() => {\r\n        const store = tree.store.value;\r\n        tree.ctx.emit(\"check\", props.node.data, {\r\n          checkedNodes: store.getCheckedNodes(),\r\n          checkedKeys: store.getCheckedKeys(),\r\n          halfCheckedNodes: store.getHalfCheckedNodes(),\r\n          halfCheckedKeys: store.getHalfCheckedKeys()\r\n        });\r\n      });\r\n    };\r\n    const handleChildNodeExpand = (nodeData, node, instance2) => {\r\n      broadcastExpanded(node);\r\n      tree.ctx.emit(\"node-expand\", nodeData, node, instance2);\r\n    };\r\n    const handleDragStart = (event) => {\r\n      if (!tree.props.draggable)\r\n        return;\r\n      emitter.emit(\"tree-node-drag-start\", { event, treeNode: props });\r\n    };\r\n    const handleDragOver = (event) => {\r\n      if (!tree.props.draggable)\r\n        return;\r\n      emitter.emit(\"tree-node-drag-over\", { event, treeNode: { $el: node$.value, node: props.node } });\r\n      event.preventDefault();\r\n    };\r\n    const handleDrop = (event) => {\r\n      event.preventDefault();\r\n    };\r\n    const handleDragEnd = (event) => {\r\n      if (!tree.props.draggable)\r\n        return;\r\n      emitter.emit(\"tree-node-drag-end\", event);\r\n    };\r\n    return {\r\n      node$,\r\n      tree,\r\n      expanded,\r\n      childNodeRendered,\r\n      oldChecked,\r\n      oldIndeterminate,\r\n      emitter,\r\n      parent,\r\n      getNodeKey: getNodeKey$1,\r\n      handleSelectChange,\r\n      handleClick,\r\n      handleContextMenu,\r\n      handleExpandIconClick,\r\n      handleCheckChange,\r\n      handleChildNodeExpand,\r\n      handleDragStart,\r\n      handleDragOver,\r\n      handleDrop,\r\n      handleDragEnd\r\n    };\r\n  }\r\n});\r\n\r\nconst _hoisted_1 = {\r\n  key: 1,\r\n  class: \"el-tree-node__loading-icon el-icon-loading\"\r\n};\r\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\r\n  const _component_el_checkbox = vue.resolveComponent(\"el-checkbox\");\r\n  const _component_node_content = vue.resolveComponent(\"node-content\");\r\n  const _component_el_tree_node = vue.resolveComponent(\"el-tree-node\");\r\n  const _component_el_collapse_transition = vue.resolveComponent(\"el-collapse-transition\");\r\n  return vue.withDirectives((vue.openBlock(), vue.createBlock(\"div\", {\r\n    ref: \"node$\",\r\n    class: [\"el-tree-node\", {\r\n      \"is-expanded\": _ctx.expanded,\r\n      \"is-current\": _ctx.node.isCurrent,\r\n      \"is-hidden\": !_ctx.node.visible,\r\n      \"is-focusable\": !_ctx.node.disabled,\r\n      \"is-checked\": !_ctx.node.disabled && _ctx.node.checked\r\n    }],\r\n    role: \"treeitem\",\r\n    tabindex: \"-1\",\r\n    \"aria-expanded\": _ctx.expanded,\r\n    \"aria-disabled\": _ctx.node.disabled,\r\n    \"aria-checked\": _ctx.node.checked,\r\n    draggable: _ctx.tree.props.draggable,\r\n    \"data-key\": _ctx.getNodeKey(_ctx.node),\r\n    onClick: _cache[3] || (_cache[3] = vue.withModifiers((...args) => _ctx.handleClick && _ctx.handleClick(...args), [\"stop\"])),\r\n    onContextmenu: _cache[4] || (_cache[4] = (...args) => _ctx.handleContextMenu && _ctx.handleContextMenu(...args)),\r\n    onDragstart: _cache[5] || (_cache[5] = vue.withModifiers((...args) => _ctx.handleDragStart && _ctx.handleDragStart(...args), [\"stop\"])),\r\n    onDragover: _cache[6] || (_cache[6] = vue.withModifiers((...args) => _ctx.handleDragOver && _ctx.handleDragOver(...args), [\"stop\"])),\r\n    onDragend: _cache[7] || (_cache[7] = vue.withModifiers((...args) => _ctx.handleDragEnd && _ctx.handleDragEnd(...args), [\"stop\"])),\r\n    onDrop: _cache[8] || (_cache[8] = vue.withModifiers((...args) => _ctx.handleDrop && _ctx.handleDrop(...args), [\"stop\"]))\r\n  }, [\r\n    vue.createVNode(\"div\", {\r\n      class: \"el-tree-node__content\",\r\n      style: { \"padding-left\": (_ctx.node.level - 1) * _ctx.tree.props.indent + \"px\" }\r\n    }, [\r\n      vue.createVNode(\"span\", {\r\n        class: [\r\n          {\r\n            \"is-leaf\": _ctx.node.isLeaf,\r\n            expanded: !_ctx.node.isLeaf && _ctx.expanded\r\n          },\r\n          \"el-tree-node__expand-icon\",\r\n          _ctx.tree.props.iconClass ? _ctx.tree.props.iconClass : \"el-icon-caret-right\"\r\n        ],\r\n        onClick: _cache[1] || (_cache[1] = vue.withModifiers((...args) => _ctx.handleExpandIconClick && _ctx.handleExpandIconClick(...args), [\"stop\"]))\r\n      }, null, 2),\r\n      _ctx.showCheckbox ? (vue.openBlock(), vue.createBlock(_component_el_checkbox, {\r\n        key: 0,\r\n        \"model-value\": _ctx.node.checked,\r\n        indeterminate: _ctx.node.indeterminate,\r\n        disabled: !!_ctx.node.disabled,\r\n        onClick: _cache[2] || (_cache[2] = vue.withModifiers(() => {\r\n        }, [\"stop\"])),\r\n        onChange: _ctx.handleCheckChange\r\n      }, null, 8, [\"model-value\", \"indeterminate\", \"disabled\", \"onChange\"])) : vue.createCommentVNode(\"v-if\", true),\r\n      _ctx.node.loading ? (vue.openBlock(), vue.createBlock(\"span\", _hoisted_1)) : vue.createCommentVNode(\"v-if\", true),\r\n      vue.createVNode(_component_node_content, {\r\n        node: _ctx.node,\r\n        \"render-content\": _ctx.renderContent\r\n      }, null, 8, [\"node\", \"render-content\"])\r\n    ], 4),\r\n    vue.createVNode(_component_el_collapse_transition, null, {\r\n      default: vue.withCtx(() => [\r\n        !_ctx.renderAfterExpand || _ctx.childNodeRendered ? vue.withDirectives((vue.openBlock(), vue.createBlock(\"div\", {\r\n          key: 0,\r\n          class: \"el-tree-node__children\",\r\n          role: \"group\",\r\n          \"aria-expanded\": _ctx.expanded\r\n        }, [\r\n          (vue.openBlock(true), vue.createBlock(vue.Fragment, null, vue.renderList(_ctx.node.childNodes, (child) => {\r\n            return vue.openBlock(), vue.createBlock(_component_el_tree_node, {\r\n              key: _ctx.getNodeKey(child),\r\n              \"render-content\": _ctx.renderContent,\r\n              \"render-after-expand\": _ctx.renderAfterExpand,\r\n              \"show-checkbox\": _ctx.showCheckbox,\r\n              node: child,\r\n              onNodeExpand: _ctx.handleChildNodeExpand\r\n            }, null, 8, [\"render-content\", \"render-after-expand\", \"show-checkbox\", \"node\", \"onNodeExpand\"]);\r\n          }), 128))\r\n        ], 8, [\"aria-expanded\"])), [\r\n          [vue.vShow, _ctx.expanded]\r\n        ]) : vue.createCommentVNode(\"v-if\", true)\r\n      ]),\r\n      _: 1\r\n    })\r\n  ], 42, [\"aria-expanded\", \"aria-disabled\", \"aria-checked\", \"draggable\", \"data-key\"])), [\r\n    [vue.vShow, _ctx.node.visible]\r\n  ]);\r\n}\r\n\r\nscript$1.render = render;\r\nscript$1.__file = \"packages/tree/src/tree-node.vue\";\r\n\r\nfunction useKeydown({ el$ }, store) {\r\n  const treeItems = vue.ref([]);\r\n  const checkboxItems = vue.ref([]);\r\n  vue.onMounted(() => {\r\n    initTabIndex();\r\n    dom.on(el$.value, \"keydown\", handleKeydown);\r\n  });\r\n  vue.onBeforeUnmount(() => {\r\n    dom.off(el$.value, \"keydown\", handleKeydown);\r\n  });\r\n  vue.onUpdated(() => {\r\n    treeItems.value = Array.from(el$.value.querySelectorAll(\"[role=treeitem]\"));\r\n    checkboxItems.value = Array.from(el$.value.querySelectorAll(\"input[type=checkbox]\"));\r\n  });\r\n  vue.watch(checkboxItems, (val) => {\r\n    val.forEach((checkbox) => {\r\n      checkbox.setAttribute(\"tabindex\", \"-1\");\r\n    });\r\n  });\r\n  const handleKeydown = (ev) => {\r\n    const currentItem = ev.target;\r\n    if (currentItem.className.indexOf(\"el-tree-node\") === -1)\r\n      return;\r\n    const code = ev.code;\r\n    treeItems.value = Array.from(el$.value.querySelectorAll(\".is-focusable[role=treeitem]\"));\r\n    const currentIndex = treeItems.value.indexOf(currentItem);\r\n    let nextIndex;\r\n    if ([aria.EVENT_CODE.up, aria.EVENT_CODE.down].indexOf(code) > -1) {\r\n      ev.preventDefault();\r\n      if (code === aria.EVENT_CODE.up) {\r\n        nextIndex = currentIndex === -1 ? 0 : currentIndex !== 0 ? currentIndex - 1 : treeItems.value.length - 1;\r\n        const startIndex = nextIndex;\r\n        while (true) {\r\n          if (store.value.getNode(treeItems.value[nextIndex].dataset.key).canFocus)\r\n            break;\r\n          nextIndex--;\r\n          if (nextIndex === startIndex) {\r\n            nextIndex = -1;\r\n            break;\r\n          }\r\n          if (nextIndex < 0) {\r\n            nextIndex = treeItems.value.length - 1;\r\n          }\r\n        }\r\n      } else {\r\n        nextIndex = currentIndex === -1 ? 0 : currentIndex < treeItems.value.length - 1 ? currentIndex + 1 : 0;\r\n        const startIndex = nextIndex;\r\n        while (true) {\r\n          if (store.value.getNode(treeItems.value[nextIndex].dataset.key).canFocus)\r\n            break;\r\n          nextIndex++;\r\n          if (nextIndex === startIndex) {\r\n            nextIndex = -1;\r\n            break;\r\n          }\r\n          if (nextIndex >= treeItems.value.length) {\r\n            nextIndex = 0;\r\n          }\r\n        }\r\n      }\r\n      nextIndex !== -1 && treeItems.value[nextIndex].focus();\r\n    }\r\n    if ([aria.EVENT_CODE.left, aria.EVENT_CODE.right].indexOf(code) > -1) {\r\n      ev.preventDefault();\r\n      currentItem.click();\r\n    }\r\n    const hasInput = currentItem.querySelector('[type=\"checkbox\"]');\r\n    if ([aria.EVENT_CODE.enter, aria.EVENT_CODE.space].indexOf(code) > -1 && hasInput) {\r\n      ev.preventDefault();\r\n      hasInput.click();\r\n    }\r\n  };\r\n  const initTabIndex = () => {\r\n    var _a;\r\n    treeItems.value = Array.from(el$.value.querySelectorAll(\".is-focusable[role=treeitem]\"));\r\n    checkboxItems.value = Array.from(el$.value.querySelectorAll(\"input[type=checkbox]\"));\r\n    const checkedItem = el$.value.querySelectorAll(\".is-checked[role=treeitem]\");\r\n    if (checkedItem.length) {\r\n      checkedItem[0].setAttribute(\"tabindex\", \"0\");\r\n      return;\r\n    }\r\n    (_a = treeItems.value[0]) == null ? void 0 : _a.setAttribute(\"tabindex\", \"0\");\r\n  };\r\n}\r\n\r\nvar script$2 = vue.defineComponent({\r\n  name: \"ElTree\",\r\n  components: { ElTreeNode: script$1 },\r\n  props: {\r\n    data: {\r\n      type: Array\r\n    },\r\n    emptyText: {\r\n      type: String,\r\n      default() {\r\n        return locale.t(\"el.tree.emptyText\");\r\n      }\r\n    },\r\n    renderAfterExpand: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    nodeKey: String,\r\n    checkStrictly: Boolean,\r\n    defaultExpandAll: Boolean,\r\n    expandOnClickNode: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    checkOnClickNode: Boolean,\r\n    checkDescendants: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    autoExpandParent: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    defaultCheckedKeys: Array,\r\n    defaultExpandedKeys: Array,\r\n    currentNodeKey: [String, Number],\r\n    renderContent: Function,\r\n    showCheckbox: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    draggable: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    allowDrag: Function,\r\n    allowDrop: Function,\r\n    props: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          children: \"children\",\r\n          label: \"label\",\r\n          disabled: \"disabled\"\r\n        };\r\n      }\r\n    },\r\n    lazy: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    highlightCurrent: Boolean,\r\n    load: Function,\r\n    filterNodeMethod: Function,\r\n    accordion: Boolean,\r\n    indent: {\r\n      type: Number,\r\n      default: 18\r\n    },\r\n    iconClass: String\r\n  },\r\n  emits: [\r\n    \"check-change\",\r\n    \"current-change\",\r\n    \"node-click\",\r\n    \"node-contextmenu\",\r\n    \"node-collapse\",\r\n    \"node-expand\",\r\n    \"check\",\r\n    \"node-drag-start\",\r\n    \"node-drag-end\",\r\n    \"node-drop\",\r\n    \"node-drag-leave\",\r\n    \"node-drag-enter\",\r\n    \"node-drag-over\"\r\n  ],\r\n  setup(props, ctx) {\r\n    const store = vue.ref(new TreeStore({\r\n      key: props.nodeKey,\r\n      data: props.data,\r\n      lazy: props.lazy,\r\n      props: props.props,\r\n      load: props.load,\r\n      currentNodeKey: props.currentNodeKey,\r\n      checkStrictly: props.checkStrictly,\r\n      checkDescendants: props.checkDescendants,\r\n      defaultCheckedKeys: props.defaultCheckedKeys,\r\n      defaultExpandedKeys: props.defaultExpandedKeys,\r\n      autoExpandParent: props.autoExpandParent,\r\n      defaultExpandAll: props.defaultExpandAll,\r\n      filterNodeMethod: props.filterNodeMethod\r\n    }));\r\n    store.value.initialize();\r\n    const root = vue.ref(store.value.root);\r\n    const currentNode = vue.ref(null);\r\n    const el$ = vue.ref(null);\r\n    const dropIndicator$ = vue.ref(null);\r\n    const { broadcastExpanded } = useNodeExpandEventBroadcast(props);\r\n    const { dragState } = useDragNodeHandler({\r\n      props,\r\n      ctx,\r\n      el$,\r\n      dropIndicator$,\r\n      store\r\n    });\r\n    useKeydown({ el$ }, store);\r\n    const isEmpty = vue.computed(() => {\r\n      const { childNodes } = root.value;\r\n      return !childNodes || childNodes.length === 0 || childNodes.every(({ visible }) => !visible);\r\n    });\r\n    vue.watch(() => props.defaultCheckedKeys, (newVal) => {\r\n      store.value.setDefaultCheckedKey(newVal);\r\n    });\r\n    vue.watch(() => props.defaultExpandedKeys, (newVal) => {\r\n      store.value.defaultExpandedKeys = newVal;\r\n      store.value.setDefaultExpandedKeys(newVal);\r\n    });\r\n    vue.watch(() => props.data, (newVal) => {\r\n      store.value.setData(newVal);\r\n    }, { deep: true });\r\n    vue.watch(() => props.checkStrictly, (newVal) => {\r\n      store.value.checkStrictly = newVal;\r\n    });\r\n    const filter = (value) => {\r\n      if (!props.filterNodeMethod)\r\n        throw new Error(\"[Tree] filterNodeMethod is required when filter\");\r\n      store.value.filter(value);\r\n    };\r\n    const getNodeKey$1 = (node) => {\r\n      return getNodeKey(props.nodeKey, node.data);\r\n    };\r\n    const getNodePath = (data) => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in getNodePath\");\r\n      const node = store.value.getNode(data);\r\n      if (!node)\r\n        return [];\r\n      const path = [node.data];\r\n      let parent = node.parent;\r\n      while (parent && parent !== root.value) {\r\n        path.push(parent.data);\r\n        parent = parent.parent;\r\n      }\r\n      return path.reverse();\r\n    };\r\n    const getCheckedNodes = (leafOnly, includeHalfChecked) => {\r\n      return store.value.getCheckedNodes(leafOnly, includeHalfChecked);\r\n    };\r\n    const getCheckedKeys = (leafOnly) => {\r\n      return store.value.getCheckedKeys(leafOnly);\r\n    };\r\n    const getCurrentNode = () => {\r\n      const currentNode2 = store.value.getCurrentNode();\r\n      return currentNode2 ? currentNode2.data : null;\r\n    };\r\n    const getCurrentKey = () => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in getCurrentKey\");\r\n      const currentNode2 = getCurrentNode();\r\n      return currentNode2 ? currentNode2[props.nodeKey] : null;\r\n    };\r\n    const setCheckedNodes = (nodes, leafOnly) => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in setCheckedNodes\");\r\n      store.value.setCheckedNodes(nodes, leafOnly);\r\n    };\r\n    const setCheckedKeys = (keys, leafOnly) => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in setCheckedKeys\");\r\n      store.value.setCheckedKeys(keys, leafOnly);\r\n    };\r\n    const setChecked = (data, checked, deep) => {\r\n      store.value.setChecked(data, checked, deep);\r\n    };\r\n    const getHalfCheckedNodes = () => {\r\n      return store.value.getHalfCheckedNodes();\r\n    };\r\n    const getHalfCheckedKeys = () => {\r\n      return store.value.getHalfCheckedKeys();\r\n    };\r\n    const setCurrentNode = (node, shouldAutoExpandParent = true) => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in setCurrentNode\");\r\n      store.value.setUserCurrentNode(node, shouldAutoExpandParent);\r\n    };\r\n    const setCurrentKey = (key, shouldAutoExpandParent = true) => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in setCurrentKey\");\r\n      store.value.setCurrentNodeKey(key, shouldAutoExpandParent);\r\n    };\r\n    const getNode = (data) => {\r\n      return store.value.getNode(data);\r\n    };\r\n    const remove = (data) => {\r\n      store.value.remove(data);\r\n    };\r\n    const append = (data, parentNode) => {\r\n      store.value.append(data, parentNode);\r\n    };\r\n    const insertBefore = (data, refNode) => {\r\n      store.value.insertBefore(data, refNode);\r\n    };\r\n    const insertAfter = (data, refNode) => {\r\n      store.value.insertAfter(data, refNode);\r\n    };\r\n    const handleNodeExpand = (nodeData, node, instance) => {\r\n      broadcastExpanded(node);\r\n      ctx.emit(\"node-expand\", nodeData, node, instance);\r\n    };\r\n    const updateKeyChildren = (key, data) => {\r\n      if (!props.nodeKey)\r\n        throw new Error(\"[Tree] nodeKey is required in updateKeyChild\");\r\n      store.value.updateChildren(key, data);\r\n    };\r\n    vue.provide(\"RootTree\", {\r\n      ctx,\r\n      props,\r\n      store,\r\n      root,\r\n      currentNode,\r\n      instance: vue.getCurrentInstance()\r\n    });\r\n    return {\r\n      store,\r\n      root,\r\n      currentNode,\r\n      dragState,\r\n      el$,\r\n      dropIndicator$,\r\n      isEmpty,\r\n      filter,\r\n      getNodeKey: getNodeKey$1,\r\n      getNodePath,\r\n      getCheckedNodes,\r\n      getCheckedKeys,\r\n      getCurrentNode,\r\n      getCurrentKey,\r\n      setCheckedNodes,\r\n      setCheckedKeys,\r\n      setChecked,\r\n      getHalfCheckedNodes,\r\n      getHalfCheckedKeys,\r\n      setCurrentNode,\r\n      setCurrentKey,\r\n      getNode,\r\n      remove,\r\n      append,\r\n      insertBefore,\r\n      insertAfter,\r\n      handleNodeExpand,\r\n      updateKeyChildren\r\n    };\r\n  }\r\n});\r\n\r\nconst _hoisted_1$1 = {\r\n  key: 0,\r\n  class: \"el-tree__empty-block\"\r\n};\r\nconst _hoisted_2 = { class: \"el-tree__empty-text\" };\r\nconst _hoisted_3 = {\r\n  ref: \"dropIndicator$\",\r\n  class: \"el-tree__drop-indicator\"\r\n};\r\nfunction render$1(_ctx, _cache, $props, $setup, $data, $options) {\r\n  const _component_el_tree_node = vue.resolveComponent(\"el-tree-node\");\r\n  return vue.openBlock(), vue.createBlock(\"div\", {\r\n    ref: \"el$\",\r\n    class: [\"el-tree\", {\r\n      \"el-tree--highlight-current\": _ctx.highlightCurrent,\r\n      \"is-dragging\": !!_ctx.dragState.draggingNode,\r\n      \"is-drop-not-allow\": !_ctx.dragState.allowDrop,\r\n      \"is-drop-inner\": _ctx.dragState.dropType === \"inner\"\r\n    }],\r\n    role: \"tree\"\r\n  }, [\r\n    (vue.openBlock(true), vue.createBlock(vue.Fragment, null, vue.renderList(_ctx.root.childNodes, (child) => {\r\n      return vue.openBlock(), vue.createBlock(_component_el_tree_node, {\r\n        key: _ctx.getNodeKey(child),\r\n        node: child,\r\n        props: _ctx.props,\r\n        \"render-after-expand\": _ctx.renderAfterExpand,\r\n        \"show-checkbox\": _ctx.showCheckbox,\r\n        \"render-content\": _ctx.renderContent,\r\n        onNodeExpand: _ctx.handleNodeExpand\r\n      }, null, 8, [\"node\", \"props\", \"render-after-expand\", \"show-checkbox\", \"render-content\", \"onNodeExpand\"]);\r\n    }), 128)),\r\n    _ctx.isEmpty ? (vue.openBlock(), vue.createBlock(\"div\", _hoisted_1$1, [\r\n      vue.createVNode(\"span\", _hoisted_2, vue.toDisplayString(_ctx.emptyText), 1)\r\n    ])) : vue.createCommentVNode(\"v-if\", true),\r\n    vue.withDirectives(vue.createVNode(\"div\", _hoisted_3, null, 512), [\r\n      [vue.vShow, _ctx.dragState.showDropIndicator]\r\n    ])\r\n  ], 2);\r\n}\r\n\r\nscript$2.render = render$1;\r\nscript$2.__file = \"packages/tree/src/tree.vue\";\r\n\r\nscript$2.install = (app) => {\r\n  app.component(script$2.name, script$2);\r\n};\r\nconst _Tree = script$2;\r\n\r\nexports.default = _Tree;\r\n"]}]}